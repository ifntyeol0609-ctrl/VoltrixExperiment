<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VoltrixèŒåœºæ™‹å‡å®éªŒç ”ç©¶</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            height: 100%;
            overflow-y: auto;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
            margin: 0;
            overflow-x: hidden;
            overflow-y: auto;
            font-size: 24px; /* æ–°å¢ï¼šå°†åŸºç¡€å­—ä½“å¤§å°æå‡50% (ä»é»˜è®¤16pxåˆ°24px) */
        }

        .container {
            max-width: 900px;
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            position: relative;
            margin: 0 auto;
            margin-bottom: 50px;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            color: #ffffff;
            font-size: 16px;
            font-weight: 500;
        }

        .back-button {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .back-button:hover {
            background: rgba(255,255,255,0.3);
        }

        .back-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .content {
            padding: 40px;
        }

        .section {
            display: none;
            animation: fadeIn 0.5s;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            color: #000; /* ä¿®æ”¹ï¼šç°è‰²æ”¹ä¸ºé»‘è‰² */
            margin-bottom: 30px; /* é€‚å½“å¢åŠ é—´è· */
            font-size: 36px; /* ä¿®æ”¹ï¼šå­—ä½“æ”¾å¤§50% */
            font-weight: bold; /* æ–°å¢ï¼šå¼ºè°ƒ */
            margin-top: 10px; /* æ–°å¢ï¼šè§£å†³é¡¶æ ¼é—®é¢˜ */
        }

        h3 {
            color: #000; /* ä¿®æ”¹ï¼šç°è‰²æ”¹ä¸ºé»‘è‰² */
            margin-bottom: 25px; /* é€‚å½“å¢åŠ é—´è· */
            font-size: 30px; /* ä¿®æ”¹ï¼šå­—ä½“æ”¾å¤§50% */
            font-weight: bold; /* æ–°å¢ï¼šå¼ºè°ƒ */
        }

        p {
            color: #000; /* ä¿®æ”¹ï¼šç°è‰²æ”¹ä¸ºé»‘è‰² */
            line-height: 2.0;
            margin-bottom: 20px;
        }

.info-box p {
            font-size: 22px; /* è®¾ç½®ä¸º22pxï¼Œè€Œä¸æ˜¯ç»§æ‰¿24px */
            line-height: 1.8; /* ç¼©å°è¡Œé«˜ï¼Œä½¿æ’ç‰ˆæ›´ç´§å‡‘ */
        }


        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #2a5298;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .success-box {
            background: linear-gradient(135deg, #ff9a56 0%, #ff6a88 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
        }

        .button-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 30px;
        }

        button {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(42, 82, 152, 0.3);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .choice-button {
            background: white;
            color: #333;
            border: 2px solid #e0e0e0;
            text-align: left;
            padding: 20px;
            position: relative;
            transition: all 0.3s;
        }

        .choice-button:hover:not(:disabled) {
            border-color: #2a5298;
            background: #f8f9fa;
        }
        
        .choice-button:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        .choice-button.selected {
            border-color: #2a5298;
            background: #f0f4ff;
        }

        .choice-button.correct {
            border-color: #4caf50;
            background: #e8f5e9;
            font-weight: 500;
        }

        .choice-button.incorrect {
            border-color: #f44336;
            background: #ffebee;
            font-weight: 500;
        }

        .quiz-progress {
            background: #e0e0e0;
            height: 8px;
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .quiz-progress-fill {
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            height: 100%;
            transition: width 0.5s;
        }

        .quiz-status {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            color: #666;
            font-size: 14px;
        }

        .level-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .level-table th, .level-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
            font-size: 20px; /* æ–°å¢ï¼šä¸ºè¡¨æ ¼è®¾ç½®ä¸€ä¸ªåˆé€‚çš„å­—ä½“å¤§å° */
        }

        .level-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }

        .level-table tr.highlight {
            background: #fff3e0;
            font-weight: 600;
        }

        .level-table tr.promoted {
            background: linear-gradient(135deg, #e8f5e9 0%, #f0f4ff 100%);
            font-weight: 600;
            animation: highlightRow 1s ease-in-out;
        }

.current-level-label {
    background: #e91e63;
    color: white;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 12px;
    position: absolute;
    top: -20px;
    left: 0;
}

        @keyframes highlightRow {
            0% { background: #fff; }
            50% { background: #fffde7; }
            100% { background: linear-gradient(135deg, #e8f5e9 0%, #f0f4ff 100%); }
        }

        .likert-scale {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .likert-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            padding: 10px;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .likert-option:hover {
            background: #e0e0e0;
        }

        .likert-radio {
            width: 20px;
            height: 20px;
            margin-bottom: 8px;
        }

        .likert-label {
            font-size: 12px;
            text-align: center;
            color: #666;
        }

        .questionnaire-item {
            margin-bottom: 25px;
            padding: 20px;
            background: #fafafa;
            border-radius: 8px;
        }

        .questionnaire-item p {
            margin-bottom: 15px;
            color: #333;
            font-weight: 500;
        }

        .celebration {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 1000;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            animation: fall 3s linear;
        }

        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: #333;
            font-weight: 500;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .radio-option:hover {
            background: #e8e9ea;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .checkbox-option {
            display: flex;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .checkbox-option:hover {
            background: #e8e9ea;
        }

        .checkbox-option input[type="checkbox"] {
            margin-right: 10px;
        }

        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            background: white;
        }

        .score-display {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            margin: 20px 0;
        }

        .score-value {
            font-size: 48px;
            font-weight: bold;
            color: #2a5298;
        }

        .score-label {
            color: #666;
            margin-top: 10px;
        }

        .chat-message {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            max-width: 80%;
            animation: slideIn 0.5s ease-out;
        }

        .chat-message.sender {
            background: #e3f2fd;
            margin-left: auto;
            text-align: right;
        }

        .chat-message.receiver {
            background: #f5f5f5;
            margin-right: auto;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .chat-container {
            background: white;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            min-height: 400px;
        }

        .chat-header {
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .error-hint {
            color: #f44336;
            font-size: 14px;
            margin-top: 5px;
        }

        .mysterious-box {
            background: #fff5e6;
            color: #333;
            padding: 40px;
            border-radius: 15px;
            margin: 20px 0;
            box-shadow: 0 10px 25px rgba(255,152,0,0.2);
            position: relative;
            overflow: hidden;
            border: 2px solid #ffcc80;
        }

        .promotion-visual {
            margin: 30px 0;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 10px;
        }

        .promotion-arrow {
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
            font-size: 24px;
            color: #2a5298;
        }

        .promotion-arrow span {
            margin: 0 20px;
        }

        .promotion-comparison {
            display: flex;
            justify-content: space-around;
            margin: 30px 0;
        }

        .promotion-comparison .level-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            flex: 1;
            margin: 0 10px;
        }

        .promotion-comparison .level-box.current {
            background: #fff3e0;
            border: 2px solid #ffa726;
        }

        .promotion-comparison .level-box.promoted {
            background: #e8f5e9;
            border: 2px solid #4caf50;
        }

        input[type="text"], input[type="number"], input[type="email"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        .emphasis-text {
            font-weight: bold;
            color: #e91e63;
            display: inline-block;
            padding: 5px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
        }

        .transition-page {
            text-align: center;
            padding: 40px;
        }

        .transition-box {
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%);
            color: #333;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .thank-you-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            margin: 20px 0;
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
        }

        .thank-you-box h2 {
            color: white;
            font-size: 32px;
            margin-bottom: 20px;
        }

        .thank-you-box p {
            color: white;
            font-size: 18px;
            margin: 15px 0;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            margin: 0 auto;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #2a5298;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .timeline-item {
            margin: 15px 0;
            padding: 15px;
            background: #f9f9f9;
            border-left: 3px solid #2a5298;
            border-radius: 5px;
        }

        .timeline-date {
            color: #2a5298;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .scenario-context {
            background: #f0f4ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .option-score {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: #2a5298;
            color: white;
            border-radius: 50%;
            margin-right: 10px;
            font-weight: bold;
        }
.level-table tr.level-past {
    background-color: #f5f5f5; /* æ—§èŒçº§ä½¿ç”¨ç°è‰²èƒŒæ™¯ */
    text-decoration: line-through; /* æ·»åŠ åˆ é™¤çº¿ */
    color: #999;
}

.level-table tr.level-current {
    background-color: #e8f5e9; /* æ–°èŒçº§ä½¿ç”¨æ·¡ç»¿è‰²èƒŒæ™¯ï¼Œè¡¨ç¤ºæˆåŠŸ */
    font-weight: bold;
    color: #2e7d32;
}

.level-table tr.level-current td:first-child::before {
    content: 'ğŸš€';
    display: inline-block;
    margin-right: 8px;
    animation: rise 1.5s ease-in-out infinite;
}

@keyframes rise {
    0% { transform: translateY(3px); opacity: 0.5; }
    50% { transform: translateY(-3px); opacity: 1; }
    100% { transform: translateY(3px); opacity: 0.5; }
}
.choice-button.correct {
    background: #e8f5e9;
    border-color: #4caf50;
    color: #2e7d32;
    font-weight: bold;
}

.choice-button.incorrect {
    background: #ffebee;
    border-color: #f44336;
    color: #c62828;
}

.choice-button:disabled {
    cursor: not-allowed;
    opacity: 0.8;
}
.fade-in-reveal {
    animation: fadeIn 1s;
}

.confetti-piece {
    position: absolute;
    width: 10px;
    height: 20px;
    background: var(--color);
    top: 0;
    left: var(--x-start);
    opacity: 0;
    animation: fall-and-sway 4s linear forwards;
    pointer-events: none;
}

@keyframes fall-and-sway {
    0% {
        transform: translateY(-100px) rotateZ(0deg);
        opacity: 1;
    }
    100% {
        transform: translateY(100vh) rotateZ(720deg);
        opacity: 0;
    }
}
/* --- å¼€å§‹ï¼šè¯·å°†ä»¥ä¸‹æ‰€æœ‰ä»£ç æ·»åŠ åˆ°<style>æ ‡ç­¾åº•éƒ¨ --- */

/* 1. ç”¨äºå¸‚åœºåé¦ˆæŒ‡æ ‡åŠ¨ç”» */
.metric-box {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.5s ease-out, transform 0.5s ease-out;
}

.metric-box.visible {
    opacity: 1;
    transform: translateY(0);
}

/* 2. ç”¨äºæ™‹å‡å†³å®šæ–‡å­—çš„â€œçªç„¶æ”¾å¤§â€åŠ¨ç”» */
.text-pop-animation {
    animation-name: text-pop;
    animation-duration: 1.5s; /* å‡æ…¢å•æ¬¡åŠ¨ç”»çš„é€Ÿåº¦ */
    animation-timing-function: cubic-bezier(0.25, 0.46, 0.45, 0.94);
    animation-fill-mode: forwards;
    animation-iteration-count: 2; /* é‡å¤åŠ¨ç”»ä¸¤æ¬¡ */
}

@keyframes text-pop {
    0% {
        transform: scale(1);
        opacity: 0.8;
    }
    25% {
        transform: scale(1.25);
        opacity: 1;
    }
    50% {
        transform: scale(1.05);
        opacity: 1;
    }
    75% {
        transform: scale(1.25);
        opacity: 1;
    }
    100% {
        transform: scale(1.1); /* åŠ¨ç”»ç»“æŸåç¨å¾®æ”¾å¤§ï¼Œä¿æŒå¼ºè°ƒ */
    }
}

/* 3. æ–°çš„ã€æ›´å¤¸å¼ çš„åº†ç¥åŠ¨ç”»æ ·å¼ */
.confetti-piece {
    position: absolute;
    width: 10px;
    height: 30px; /* æ”¹ä¸ºé•¿æ¡å½¢ï¼Œæ›´åƒå½©å¸¦ */
    background: var(--color);
    top: -50px; /* ä»å±å¹•å¤–å¼€å§‹ */
    left: var(--x-start);
    opacity: 0;
    animation: fall-and-sway 4s linear forwards; /* ä¿®æ”¹ï¼šå°†æŒç»­æ—¶é—´ä»6ç§’ç¼©çŸ­ä¸º4ç§’ï¼Œä½¿å…¶æ›´å¿« */
    pointer-events: none;
    border-radius: 4px;
}

/* å¢åŠ æ—‹è½¬åŠ¨ç”» */
@keyframes fall-and-sway {
    0% {
        transform: translateY(0) rotateZ(0deg) rotateX(0deg);
        opacity: 1;
    }
    100% {
        transform: translateY(110vh) rotateZ(1080deg) rotateX(720deg); /* å¢åŠ æ—‹è½¬ */
        opacity: 0;
    }
}

/* --- ä¸ºè¿‡æ¸¡é¡µæ ‡é¢˜å¢åŠ çš„é†’ç›®åŠ¨ç”» --- */
.title-pop-in {
    animation: pop-in 1.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    transform-origin: center;
}

@keyframes pop-in {
    0% {
        transform: scale(0.6);
        opacity: 0;
    }
    60% {
        transform: scale(1.1);
        opacity: 1;
    }
    100% {
        transform: scale(1);
    }
}
/* --- åŠ¨ç”»ä»£ç ç»“æŸ --- */

/* --- ç»“æŸï¼šæ–°å¢CSSä»£ç åˆ°æ­¤ä¸ºæ­¢ --- */
 /* --- ä¸ºè¿‡æ¸¡é¡µæ ‡é¢˜å¢åŠ çš„ã€æ›´æ˜¾çœ¼çš„é—ªçƒåŠ¨ç”» --- */
.title-flash-animation {
    animation: text-flash 2.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) 4; /* åŠ¨ç”»æ—¶é•¿2.5ç§’ï¼Œé‡å¤4æ¬¡ */
    transform-origin: center;
}

@keyframes text-flash {
    0%, 50%, 100% {
        transform: scale(1);
        opacity: 0.9;
    }
    25%, 75% {
        transform: scale(1.15);
        opacity: 1;
        text-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
    }
}
/* --- åŠ¨ç”»ä»£ç ç»“æŸ --- */   


/* --- å¼€å§‹ï¼šè¿™æ˜¯å®ç°æ–°ç‰ˆç­‰è·å¸ƒå±€çš„CSS --- */
.likert-option {
    width: 125px; /* å…³é”®ï¼šä¸ºæ¯ä¸ªé€‰é¡¹è®¾ç½®ä¸€ä¸ªå›ºå®šçš„å®½åº¦ */
}

.likert-label {
    font-size: 18px; /* å‡å°æ–‡å­—å­—å· */
    color: #000; /* å°†ç°è‰²æ–‡å­—æ”¹ä¸ºé»‘è‰² */
}

.label-align-left {
    text-align: left; /* æ–°å¢ï¼šå·¦å¯¹é½ç±» */
}

.label-align-right {
    text-align: right; /* æ–°å¢ï¼šå³å¯¹é½ç±» */
}
/* --- ç»“æŸï¼šæ–°ç‰ˆCSSåˆ°æ­¤ä¸ºæ­¢ --- */


</style>
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.15.0/dist/av-min.js"></script>
</head>
<body>
<script>
// åˆå§‹åŒ–å…¨å±€çŠ¶æ€ - å¿…é¡»æ”¾åœ¨æœ€å‰é¢
window.gameState = {
    currentSection: 'welcome',
    navigationHistory: [],
    inReviewMode: false,
    quizInReviewMode: false,
    yearTasks: [],
    currentYearTask: 0,
    yearTaskAnswers: [],
    quizQuestions: [],
    currentQuestionIndex: 0,
    correctAnswers: 0,
    quizAnswers: [],
    quizCompleted: false,
    promotionType: '', 
    promotionLevel: '',
    mysteryReason: '',
    surveyData: {
        reciprocal: [],
        rule: [],
        moralIdentity: [],
        imposter: [],
        pride: [],
        accomplishment: [],
        thriving: [],
        rbse: [],
        riskPreference: []
    },
    behaviorData: {
        reciprocal: [],
        rule: []
    },
    behaviorScores: {
        reciprocal: 0,
        rule: 0
    },
    currentScenario: 0,
    scenariosCompleted: false,
    demographics: {},
    personalityData: { 
    // honesty å’Œ entitlement (ä»æ­¤) å·²è¢«åˆ é™¤
    // entitlement å·²ä¿å­˜åœ¨ surveyData
},
    startTime: new Date(),
    endTime: null,
    participantId: ''
};
</script>

    <div class="container">
        <div class="header">
            <button class="back-button" id="backBtn" onclick="goBack()" disabled>â† è¿”å›</button>
            <h1>Voltrix æ–°èƒ½æºæ±½è½¦å…¬å¸</h1>
            <p>èŒåœºæ™‹å‡å®éªŒç ”ç©¶</p>
        </div>

        <div class="content">
            <div class="section active" id="welcome">
                <h2>æ¬¢è¿æ‚¨å‚ä¸æœ¬ç ”ç©¶</h2>
                <div class="info-box">
                    <p><strong>æ¬¢è¿æ‚¨å‚ä¸ç”±æ¹–åŒ—ç»æµå­¦é™¢ç»„ç»‡ç®¡ç†ç ”ç©¶å›¢é˜Ÿå¼€å±•çš„å®éªŒè°ƒç ”ï¼</strong></p>
                    <p>è¯·åœ¨å¼€å§‹å‰è®¤çœŸé˜…è¯»ä»¥ä¸‹è°ƒç ”è¯´æ˜ï¼š</p>
                    
                    <ol style="margin-left: 20px; color: #666;">
                        <li style="margin: 10px 0;">æœ¬å®éªŒæ—¨åœ¨äº†è§£èŒåœºå‘˜å·¥åœ¨ä¼ä¸šè¢«"<strong>æ™‹å‡ææ‹”</strong>"è‡³æ›´é«˜å²—ä½çš„ç»å†å’Œæ„Ÿå—ã€‚</li>
                        <li style="margin: 10px 0;">æœ¬å®éªŒä»¥å­¦æœ¯ç ”ç©¶ä¸ºç›®çš„ï¼Œå±äºå­¦æœ¯æ€§è´¨çš„è°ƒç ”ï¼Œ<strong>ä¸ä¼šå¦ä½œä»–ç”¨ï¼Œä¹Ÿä¸æ¶‰åŠä»»ä½•è·Ÿä¸ªäººç›¸å…³çš„è€ƒè¯„</strong>ã€‚æ‚¨æ‰€æä¾›çš„æ‰€æœ‰ä¿¡æ¯å°†<strong>ä¸¥æ ¼ä¿å¯†</strong>ï¼Œæ‚¨æä¾›çš„é€‰æ‹©ä¹Ÿä¸ä¼šæœ‰å¯¹é”™ä¹‹åˆ†ï¼Œæ‚¨å¯ä»¥æ”¾å¿ƒå‚ä¸æ­¤æ¬¡å®éªŒï¼Œè‡ªç”±åœ°è¡¨è¾¾æ‚¨çš„çœŸå®æƒ³æ³•ã€‚å®Œæˆæœ¬å®éªŒçº¦éœ€30åˆ†é’Ÿï¼Œè¯·ç¡®è®¤æ‚¨æ˜¯<strong>è‡ªæ„¿å‚ä¸</strong>æœ¬æ¬¡å®éªŒã€‚</li>
                        <li style="margin: 10px 0;">æ‚¨åœ¨æœ¬å®éªŒä¸­æ‰€æä¾›çš„ä¿¡æ¯å’Œè¡¨è¾¾çš„æƒ³æ³•çš„çœŸå®æ€§å¯¹äºè¯¾é¢˜ç»„å¾—å‡ºç§‘å­¦å¯é çš„ç ”ç©¶ç»“è®ºè‡³å…³é‡è¦ï¼Œå¦‚æ‚¨æä¾›çš„ä¿¡æ¯ä¸å®ï¼Œæˆ–è€…åˆ»æ„éšç’æ‚¨çš„çœŸå®æƒ³æ³•ï¼Œå°†ä¼šå¯¹æœ¬æ¬¡è°ƒç ”çš„ç§‘å­¦æ€§å’Œæœ‰æ•ˆæ€§äº§ç”Ÿä¸¥é‡å½±å“ï¼Œå¯¼è‡´è¯¾é¢˜ç»„è°ƒç ”å¤±è´¥ã€‚æ‚¨çš„è®¤çœŸå‚ä¸å’Œç§¯ææ”¯æŒæ˜¯æœ¬è°ƒç ”æˆåŠŸçš„å…³é”®æ‰€åœ¨ï¼Œè¯·æ‚¨åŠ¡å¿…è®¤çœŸé˜…è¯»é¢˜ç›®ï¼ŒæŒ‰ç…§æ‚¨çš„çœŸå®æƒ³æ³•ä½œç­”ã€‚</li>
                    </ol>
                    
                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #ddd;">
                        <p style="font-size: 14px;">å¦‚æ‚¨å¯¹æœ¬å®éªŒæœ‰ä»»ä½•é—®é¢˜æˆ–è€…å»ºè®®ï¼Œæ¬¢è¿é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»æˆ‘ä»¬ï¼Œå†æ¬¡æ„Ÿè°¢æ‚¨çš„å‚ä¸å’Œæ”¯æŒï¼</p>
                        <p style="font-size: 14px; margin-top: 10px;">
                            é­å¥³å£« ç ”ç©¶åŠ©ç†<br>
                            æ¹–åŒ—ç»æµå­¦é™¢ç»„ç»‡ç®¡ç†ç ”ç©¶è¯¾é¢˜ç»„<br>
                            é‚®ç®±ï¼š1327785762@qq.com
                        </p>
                    </div>
                </div>
              <button onclick="navigateTo('background')">æˆ‘å·²äº†è§£å¹¶åŒæ„å‚ä¸</button>
            </div>

            <div class="section" id="background">
                <h2>å…¬å¸èƒŒæ™¯ä»‹ç»</h2>
                <div class="info-box">
                    <h3>Voltrix æ–°èƒ½æºæ±½è½¦å…¬å¸</h3>
                    <p>Voltrix æ˜¯ä¸€å®¶æˆç«‹10å¹´çš„æ–°èƒ½æºæ±½è½¦ä¼ä¸šï¼Œä¸“æ³¨äºæ™ºèƒ½é©¾é©¶æŠ€æœ¯çš„ç ”å‘ä¸åˆ›æ–°ã€‚å…¬å¸æ‹¥æœ‰å®Œå–„çš„èŒçº§ä½“ç³»ï¼Œä¸ºå‘˜å·¥æä¾›æ¸…æ™°çš„èŒä¸šå‘å±•è·¯å¾„ã€‚</p>
                    <p style="color: #e91e63; font-weight: bold; background-color: #fffbe6; padding: 10px; border-radius: 8px;">æ‰€åˆ—å¹´é™æŒ‡è¿›å…¥è¯¥èŒçº§æ‰€éœ€å…·å¤‡çš„æœ€ä½å·¥ä½œç»éªŒæ—¶é•¿ï¼Œä½†æ™‹å‡å¹¶ééšç»éªŒå¹´é™è‡ªåŠ¨å‘ç”Ÿï¼Œè¿˜éœ€ç»“åˆä¸ªäººèƒ½åŠ›ã€ä¸šç»©è¡¨ç°åŠç»„ç»‡éœ€æ±‚ç»¼åˆè¯„ä¼°å†³å®šã€‚</p>
                </div>
                
                <h3>æŠ€æœ¯åºåˆ—èŒçº§ä½“ç³»</h3>
                <table class="level-table" id="main-level-table">
    <tr style="white-space: nowrap;">
        <th>èŒçº§</th>
        <th>èŒä½åç§°</th>
        <th>å…¸å‹èŒè´£</th>
        <th>ä»»èŒå¹´é™è¦æ±‚</th>
    </tr>
                    <tr>
                        <td>L1</td>
                        <td>åˆçº§å·¥ç¨‹å¸ˆ</td>
                        <td>åŸºç¡€æ¨¡å—å¼€å‘ï¼›ä»£ç ç»´æŠ¤ï¼›æ•°æ®å¤„ç†ä¸æµ‹è¯•</td>
                        <td>1-3å¹´</td>
                    </tr>
                    <tr>
                        <td>L2</td>
                        <td>ä¸­çº§å·¥ç¨‹å¸ˆ</td>
                        <td>ç‹¬ç«‹è´Ÿè´£å­ç³»ç»Ÿå¼€å‘ï¼›æ€§èƒ½ä¼˜åŒ–ï¼›ç¼ºé™·ä¿®å¤ä¸ä¼˜åŒ–</td>
                        <td>2-4å¹´</td>
                    </tr>
                    <tr>
                        <td>L3</td>
                        <td>é«˜çº§å·¥ç¨‹å¸ˆ</td>
                        <td>ä¸»å¯¼ç®—æ³•è®¾è®¡ï¼›è·¨å›¢é˜Ÿåä½œï¼›æ¨¡å‹éƒ¨ç½²ä¸è§„æ¨¡åŒ–åº”ç”¨</td>
                        <td>3-5å¹´</td>
                    </tr>
                    <tr>
                        <td>L4</td>
                        <td>ä¸“å®¶å·¥ç¨‹å¸ˆ</td>
                        <td>å¤æ‚é—®é¢˜è§£å†³ï¼›æ¶æ„è®¾è®¡ï¼›æŒ‡å¯¼åˆçº§å·¥ç¨‹å¸ˆ</td>
                        <td>4-6å¹´</td>
                    </tr>
                    <tr>
                        <td>L5</td>
                        <td>èµ„æ·±ä¸“å®¶å·¥ç¨‹å¸ˆ</td>
                        <td>åˆ¶å®šæˆ˜ç•¥ç ”å‘æ–¹å‘ï¼›å®ç°èƒ½å¸¦æ¥æ˜¾è‘—æˆæ•ˆçš„ä¼˜åŒ–ï¼›æä¾›æŠ€æœ¯å‘å±•è·¯çº¿çš„å»ºè®®</td>
                        <td>6-8å¹´</td>
                    </tr>
                    <tr>
                        <td>L6</td>
                        <td>é¦–å¸­ä¸“å®¶</td>
                        <td>å…¨å…¬å¸æŠ€æœ¯é¢†å¯¼åŠ›ï¼›å‰æ²¿åˆ›æ–°</td>
                        <td>7-10å¹´</td>
                    </tr>
                    <tr>
                        <td>L7</td>
                        <td>æŠ€æœ¯æ€»ç›‘</td>
                        <td>é«˜ç®¡å±‚å†³ç­–ï¼›ä½¿æŠ€æœ¯ä¸ä¸šåŠ¡å¤§æ–¹å‘å¯¹é½ï¼›é•¿æœŸæˆ˜ç•¥æ„¿æ™¯</td>
                        <td>>10å¹´</td>
                    </tr>
                </table>

                <div class="info-box" style="margin-top: 30px;">
                    <p><strong>è¯·ä»”ç»†é˜…è¯»ä¸Šè¿°èŒçº§è¡¨</strong></p>
                    <p>ä»¥ä¸‹æµ‹è¯•æ˜¯ä¸ºäº†ç¡®è®¤æ‚¨å®Œå…¨äº†è§£äº†Voltrixå…¬å¸çš„èŒçº§åºåˆ—å’Œæ™‹å‡è§„åˆ™ï¼Œä»¥ä¾¿äºå¼€å±•åç»­çš„å®éªŒã€‚</p>
                </div>
                
                <div style="margin: 20px 0;">
    <p><strong>é—®é¢˜1ï¼šè¯·å®Œæˆä¸‹é¢çš„èŒçº§åºåˆ—è¡¨ï¼ˆä»ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©æ­£ç¡®çš„é€‰é¡¹ï¼‰</strong></p>
    <table class="level-table" style="margin-top: 15px;">
        <tr>
            <th>èŒçº§</th>
            <th>èŒä½åç§°</th>
            <th>ä»»èŒå¹´é™è¦æ±‚</th>
        </tr>
        <tr>
            <td>L1</td>
            <td>åˆçº§å·¥ç¨‹å¸ˆ</td>
            <td>1-3å¹´</td>
        </tr>
        <tr>
            <td>L2</td>
            <td>
                <select id="test1-L2-title" style="width: 100%;">
                    <option value="">è¯·é€‰æ‹©...</option>
                    <option value="åˆçº§å·¥ç¨‹å¸ˆ">åˆçº§å·¥ç¨‹å¸ˆ</option>
                    <option value="ä¸­çº§å·¥ç¨‹å¸ˆ">ä¸­çº§å·¥ç¨‹å¸ˆ</option>
                    <option value="é«˜çº§å·¥ç¨‹å¸ˆ">é«˜çº§å·¥ç¨‹å¸ˆ</option>
                    <option value="ä¸“å®¶å·¥ç¨‹å¸ˆ">ä¸“å®¶å·¥ç¨‹å¸ˆ</option>
                    <option value="èµ„æ·±ä¸“å®¶å·¥ç¨‹å¸ˆ">èµ„æ·±ä¸“å®¶å·¥ç¨‹å¸ˆ</option>
                    <option value="é¦–å¸­ä¸“å®¶">é¦–å¸­ä¸“å®¶</option>
                    <option value="æŠ€æœ¯æ€»ç›‘">æŠ€æœ¯æ€»ç›‘</option>
                </select>
            </td>
            <td>2-4å¹´</td>
        </tr>
        <tr>
            <td>L3</td>
            <td>
                <select id="test1-L3-title" style="width: 100%;">
                    <option value="">è¯·é€‰æ‹©...</option>
                    <option value="åˆçº§å·¥ç¨‹å¸ˆ">åˆçº§å·¥ç¨‹å¸ˆ</option>
                    <option value="ä¸­çº§å·¥ç¨‹å¸ˆ">ä¸­çº§å·¥ç¨‹å¸ˆ</option>
                    <option value="é«˜çº§å·¥ç¨‹å¸ˆ">é«˜çº§å·¥ç¨‹å¸ˆ</option>
                    <option value="ä¸“å®¶å·¥ç¨‹å¸ˆ">ä¸“å®¶å·¥ç¨‹å¸ˆ</option>
                    <option value="èµ„æ·±ä¸“å®¶å·¥ç¨‹å¸ˆ">èµ„æ·±ä¸“å®¶å·¥ç¨‹å¸ˆ</option>
                    <option value="é¦–å¸­ä¸“å®¶">é¦–å¸­ä¸“å®¶</option>
                    <option value="æŠ€æœ¯æ€»ç›‘">æŠ€æœ¯æ€»ç›‘</option>
                </select>
            </td>
            <td>3-5å¹´</td>
        </tr>
        <tr>
            <td>L4</td>
            <td>ä¸“å®¶å·¥ç¨‹å¸ˆ</td>
            <td>
                <select id="test1-L4-years" style="width: 100%;">
                    <option value="">è¯·é€‰æ‹©...</option>
                    <option value="1-3å¹´">1-3å¹´</option>
                    <option value="2-4å¹´">2-4å¹´</option>
                    <option value="3-5å¹´">3-5å¹´</option>
                    <option value="4-6å¹´">4-6å¹´</option>
                    <option value="6-8å¹´">6-8å¹´</option>
                    <option value="7-10å¹´">7-10å¹´</option>
                    <option value=">10å¹´">>10å¹´</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>L5</td>
            <td>èµ„æ·±ä¸“å®¶å·¥ç¨‹å¸ˆ</td>
            <td>
                <select id="test1-L5-years" style="width: 100%;">
                    <option value="">è¯·é€‰æ‹©...</option>
                    <option value="1-3å¹´">1-3å¹´</option>
                    <option value="2-4å¹´">2-4å¹´</option>
                    <option value="3-5å¹´">3-5å¹´</option>
                    <option value="4-6å¹´">4-6å¹´</option>
                    <option value="6-8å¹´">6-8å¹´</option>
                    <option value="7-10å¹´">7-10å¹´</option>
                    <option value=">10å¹´">>10å¹´</option>
                </select>
            </td>
        </tr>
        <tr>
            <td>L6</td>
            <td>é¦–å¸­ä¸“å®¶</td>
            <td>7-10å¹´</td>
        </tr>
        <tr>
            <td>L7</td>
            <td>æŠ€æœ¯æ€»ç›‘</td>
            <td>>10å¹´</td>
        </tr>
    </table>
    <div id="test1-error" class="error-hint"></div>
</div>

                <div style="margin: 20px 0;">
                    <p><strong>é—®é¢˜2ï¼šæ ¹æ®å¸¸è§„æ™‹å‡è·¯å¾„ï¼Œä¸­çº§å·¥ç¨‹å¸ˆçš„ä¸‹ä¸€ä¸ªæ™‹å‡èŒä½æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
                    <select id="test2-answer">
                        <option value="">è¯·é€‰æ‹©...</option>
                        <option value="åˆçº§å·¥ç¨‹å¸ˆ">åˆçº§å·¥ç¨‹å¸ˆ</option>
                        <option value="é«˜çº§å·¥ç¨‹å¸ˆ">é«˜çº§å·¥ç¨‹å¸ˆ</option>
                        <option value="ä¸“å®¶å·¥ç¨‹å¸ˆ">ä¸“å®¶å·¥ç¨‹å¸ˆ</option>
                        <option value="èµ„æ·±ä¸“å®¶å·¥ç¨‹å¸ˆ">èµ„æ·±ä¸“å®¶å·¥ç¨‹å¸ˆ</option>
                        <option value="é¦–å¸­ä¸“å®¶">é¦–å¸­ä¸“å®¶</option>
                    </select>
                    <div id="test2-error" class="error-hint"></div>
                </div>

                <div style="margin: 20px 0;">
                    <p><strong>é—®é¢˜3ï¼šä»å„èŒçº§çš„ä»»èŒå¹´é™è¦æ±‚æ¥çœ‹ï¼Œå…¥èŒ4å¹´çš„å·¥ç¨‹å¸ˆå¯èƒ½å¤„äºå“ªäº›èŒçº§ï¼Ÿï¼ˆå¤šé€‰ï¼‰</strong></p>
                    <div class="checkbox-group">
                        <label class="checkbox-option">
                            <input type="checkbox" name="test3" value="L1"> L1
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="test3" value="L2"> L2
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="test3" value="L3"> L3
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="test3" value="L4"> L4
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" name="test3" value="L5"> L5
                        </label>
                    </div>
                    <div id="test3-error" class="error-hint"></div>
                </div>

                <button onclick="validateAndProceed()">æäº¤ç­”æ¡ˆ</button>
            </div>

            <div class="section" id="test-success">
                <div class="success-box">
                    <h2 style="color: white;">ğŸ‰ æ­å–œï¼</h2>
                    <p style="font-size: 18px; color: white;">æ‚¨å·²ç»å®Œå…¨äº†è§£äº†Voltrixå…¬å¸çš„èŒçº§åºåˆ—ï¼</p>
                    <p style="font-size: 20px; font-weight: bold; margin-top: 20px; color: white;">
                        ç°åœ¨è®©æˆ‘ä»¬è¿›å…¥å…·ä½“çš„ä»»åŠ¡åœºæ™¯
                    </p>
                </div>
                <button onclick="nextSection('test-success', 'personal-background')">è¿›å…¥ä»»åŠ¡åœºæ™¯</button>
            </div>

           <div class="section" id="personal-background">
    <h2>æ‚¨çš„è§’è‰²èƒŒæ™¯</h2>
    
    <table class="level-table">
        <tr>
            <th>èŒçº§</th>
            <th>èŒä½åç§°</th>
            <th>å…¸å‹èŒè´£</th>
            <th>ä»»èŒå¹´é™è¦æ±‚</th>
        </tr>
       <tr class="highlight"> <td>
                <span style="background: #e91e63; color: white; padding: 2px 8px; border-radius: 4px; font-size: 18px; margin-right: 8px; white-space: nowrap;">æ‚¨å½“å‰çš„èŒçº§</span>
                L1
            </td>
            <td>åˆçº§å·¥ç¨‹å¸ˆ</td>
            <td>åŸºç¡€æ¨¡å—å¼€å‘ï¼›ä»£ç ç»´æŠ¤ï¼›æ•°æ®å¤„ç†ä¸æµ‹è¯•</td>
            <td>1-3å¹´</td>
        </tr>
        <tr>
            <td>L2</td>
            <td>ä¸­çº§å·¥ç¨‹å¸ˆ</td>
            <td>ç‹¬ç«‹è´Ÿè´£å­ç³»ç»Ÿå¼€å‘ï¼›æ€§èƒ½ä¼˜åŒ–ï¼›ç¼ºé™·ä¿®å¤ä¸ä¼˜åŒ–</td>
            <td>2-4å¹´</td>
        </tr>
        <tr>
            <td>L3</td>
            <td>é«˜çº§å·¥ç¨‹å¸ˆ</td>
            <td>ä¸»å¯¼ç®—æ³•è®¾è®¡ï¼›è·¨å›¢é˜Ÿåä½œï¼›æ¨¡å‹éƒ¨ç½²ä¸è§„æ¨¡åŒ–åº”ç”¨</td>
            <td>3-5å¹´</td>
        </tr>
        <tr>
            <td>L4</td>
            <td>ä¸“å®¶å·¥ç¨‹å¸ˆ</td>
            <td>å¤æ‚é—®é¢˜è§£å†³ï¼›æ¶æ„è®¾è®¡ï¼›æŒ‡å¯¼åˆçº§å·¥ç¨‹å¸ˆ</td>
            <td>4-6å¹´</td>
        </tr>
        <tr>
            <td>L5</td>
            <td>èµ„æ·±ä¸“å®¶å·¥ç¨‹å¸ˆ</td>
            <td>åˆ¶å®šæˆ˜ç•¥ç ”å‘æ–¹å‘ï¼›å®ç°èƒ½å¸¦æ¥æ˜¾è‘—æˆæ•ˆçš„ä¼˜åŒ–ï¼›æä¾›æŠ€æœ¯å‘å±•è·¯çº¿çš„å»ºè®®</td>
            <td>6-8å¹´</td>
        </tr>
        <tr>
            <td>L6</td>
            <td>é¦–å¸­ä¸“å®¶</td>
            <td>å…¨å…¬å¸æŠ€æœ¯é¢†å¯¼åŠ›ï¼›å‰æ²¿åˆ›æ–°</td>
            <td>7-10å¹´</td>
        </tr>
        <tr>
            <td>L7</td>
            <td>æŠ€æœ¯æ€»ç›‘</td>
            <td>é«˜ç®¡å±‚å†³ç­–ï¼›ä½¿æŠ€æœ¯ä¸ä¸šåŠ¡å¤§æ–¹å‘å¯¹é½ï¼›é•¿æœŸæˆ˜ç•¥æ„¿æ™¯</td>
            <td>>10å¹´</td>
        </tr>
    </table>
                   <div class="info-box" style="background-color: #f0f4ff; border-left-color: #e91e63;"> 
    <h3>æ‚¨çš„ä¸ªäººèƒŒæ™¯</h3>
    <p style="color: #000; font-size: 27px;">æ‚¨æ˜¯æ™ºèƒ½é©¾é©¶éƒ¨é—¨çš„ç®—æ³•å·¥ç¨‹å¸ˆï¼Œ<strong style="background-color: #ffecb3; padding: 2px 8px; border-radius: 4px;">å…¥èŒ2å¹´</strong>ï¼Œç›®å‰èŒçº§ä¸º<strong style="background-color: #ffecb3; padding: 2px 8px; border-radius: 4px;">L1åˆçº§å·¥ç¨‹å¸ˆ</strong>ã€‚æ‚¨è´Ÿè´£åŸºç¡€æ¨¡å—å¼€å‘ã€ä»£ç ç»´æŠ¤å’Œæ•°æ®å¤„ç†ä¸æµ‹è¯•å·¥ä½œã€‚</p> 
    <p style="color: #000; font-weight: bold; font-size: 27px;">æ¥ä¸‹æ¥ï¼Œæ‚¨å°†ç»å†ç¬¬ä¸‰å¹´å·¥ä½œä¸­çš„ä»»åŠ¡å’ŒæŒ‘æˆ˜ã€‚ç¥æ‚¨é¡ºåˆ©ã€‚</p> 
</div>
                
               <button onclick="startYearTasks()">å¼€å§‹ç¬¬ä¸‰å¹´çš„å·¥ä½œ</button>
            </div>

            <div class="section" id="year-tasks">
                <h2>æ‚¨çš„å·¥ä½œå†ç¨‹ï¼ˆç¬¬3å¹´ï¼‰</h2>
                <div class="info-box">
                    <p>ä»¥ä¸‹æ˜¯æ‚¨åœ¨ç¬¬ä¸‰å¹´æœŸé—´é‡åˆ°çš„å„ç§ä»»åŠ¡æŒ‘æˆ˜ï¼Œè¯·æ ¹æ®å…·ä½“æƒ…å†µé€‰æ‹©æœ€åˆé€‚çš„å¤„ç†æ–¹å¼ã€‚</p>
                </div>
                
                <div id="year-task-container"></div>
                <div class="button-group" id="year-task-options"></div>
                <button id="next-year-task-btn" onclick="nextYearTask()" style="display: none;">ä¸‹ä¸€ä¸ªä»»åŠ¡</button>
            </div>

<div class="section" id="year-tasks-summary">
                <h2>ç¬¬ä¸‰å¹´å·¥ä½œæ€»ç»“</h2>
                <div class="info-box" id="year-tasks-result-summary">
                    </div>
                <p>æ‚¨å·²ç»å®Œæˆäº†ç¬¬ä¸‰å¹´çš„æ‰€æœ‰å·¥ä½œæŒ‘æˆ˜ã€‚ç°åœ¨ï¼Œå…¬å¸å°†æ ¹æ®æ‚¨è¿™ä¸€å¹´çš„è¡¨ç°è¿›å…¥å¹´åº¦èŒçº§è¯„ä¼°ç¨‹åºã€‚</p>
                <button id="view-assessment-btn">æŸ¥çœ‹è¯„ä¼°ç»“æœ</button>
            </div>
            

            <div class="section" id="year-promotion">
    <h2>å¹´åº¦èŒçº§è¯„ä¼°ç»“æœ</h2>
    <div class="success-box">
    <h3 style="color: white; font-size: 28px; margin-bottom: 15px;">ğŸŠ æ­å–œæ™‹å‡ï¼</h3>
    <p style="color: white; font-size: 22px; line-height: 1.8; font-weight: 500;">ä¾æ®å…¬å¸ç°æœ‰çš„æ™‹å‡ä½“ç³»ï¼Œåœ¨å¹´åº¦èŒçº§è¯„ä¼°ä¸­ï¼Œç»¼åˆæ‚¨è¿™ä¸€å¹´å„æ–¹é¢çš„è¡¨ç°ã€è´¡çŒ®ä¸å…¥èŒå¹´é™ï¼Œç»è¿‡è¯„ä¼°æ‚¨ä»L1è¢«ææ‹”è‡³L2ï¼</p>
</div>

    <table class="level-table" style="margin-top: 30px; margin-bottom: 20px;">
        <thead>
            <tr>
                <th>èŒçº§</th>
                <th>èŒä½åç§°</th>
                <th>å…¸å‹èŒè´£</th>
                <th>ä»»èŒå¹´é™è¦æ±‚</th>
            </tr>
        </thead>
       <tbody>
  <tr class="level-past">
    <td style="white-space: nowrap;">
        <span style="background: #9e9e9e; color: white; padding: 2px 6px; border-radius: 4px; font-size: 12px; margin-right: 8px; text-decoration: none; display: inline-block;">ä¹‹å‰çš„èŒçº§</span>
        L1
    </td>
        <td>åˆçº§å·¥ç¨‹å¸ˆ</td>
        <td>åŸºç¡€æ¨¡å—å¼€å‘ï¼›ä»£ç ç»´æŠ¤ï¼›æ•°æ®å¤„ç†ä¸æµ‹è¯•</td>
        <td>1-3å¹´</td>
    </tr>
    <tr class="level-current">
    <td style="white-space: nowrap;">
        <span style="background: #4caf50; color: white; padding: 2px 6px; border-radius: 4px; font-size: 12px; margin-right: 8px;">ææ‹”åçš„èŒçº§</span>
        L2
    </td>
        <td>ä¸­çº§å·¥ç¨‹å¸ˆ</td>
        <td>ç‹¬ç«‹è´Ÿè´£å­ç³»ç»Ÿå¼€å‘ï¼›æ€§èƒ½ä¼˜åŒ–ï¼›ç¼ºé™·ä¿®å¤ä¸ä¼˜åŒ–</td>
        <td>2-4å¹´</td>
    </tr>
            <tr>
                <td>L3</td>
                <td>é«˜çº§å·¥ç¨‹å¸ˆ</td>
                <td>ä¸»å¯¼ç®—æ³•è®¾è®¡ï¼›è·¨å›¢é˜Ÿåä½œï¼›æ¨¡å‹éƒ¨ç½²ä¸è§„æ¨¡åŒ–åº”ç”¨</td>
                <td>3-5å¹´</td>
            </tr>
            <tr>
                <td>L4</td>
                <td>ä¸“å®¶å·¥ç¨‹å¸ˆ</td>
                <td>å¤æ‚é—®é¢˜è§£å†³ï¼›æ¶æ„è®¾è®¡ï¼›æŒ‡å¯¼åˆçº§å·¥ç¨‹å¸ˆ</td>
                <td>4-6å¹´</td>
            </tr>
            <tr>
                <td>L5</td>
                <td>èµ„æ·±ä¸“å®¶å·¥ç¨‹å¸ˆ</td>
                <td>åˆ¶å®šæˆ˜ç•¥ç ”å‘æ–¹å‘ï¼›å®ç°èƒ½å¸¦æ¥æ˜¾è‘—æˆæ•ˆçš„ä¼˜åŒ–ï¼›æä¾›æŠ€æœ¯å‘å±•è·¯çº¿çš„å»ºè®®</td>
                <td>6-8å¹´</td>
            </tr>
            <tr>
                <td>L6</td>
                <td>é¦–å¸­ä¸“å®¶</td>
                <td>å…¨å…¬å¸æŠ€æœ¯é¢†å¯¼åŠ›ï¼›å‰æ²¿åˆ›æ–°</td>
                <td>7-10å¹´</td>
            </tr>
            <tr>
                <td>L7</td>
                <td>æŠ€æœ¯æ€»ç›‘</td>
                <td>é«˜ç®¡å±‚å†³ç­–ï¼›ä½¿æŠ€æœ¯ä¸ä¸šåŠ¡å¤§æ–¹å‘å¯¹é½ï¼›é•¿æœŸæˆ˜ç•¥æ„¿æ™¯</td>
                <td>>10å¹´</td>
            </tr>
        </tbody>
    </table>
    <div class="info-box">
        <h3>æ‚¨çš„æ–°èŒä½</h3>
        <p><strong>èŒçº§ï¼šL2 - ä¸­çº§å·¥ç¨‹å¸ˆ</strong></p>
        <p><strong>å…¥èŒå¹´é™ï¼š3å¹´</strong></p>
        <p><strong>å…¸å‹èŒè´£ï¼š</strong>ç‹¬ç«‹è´Ÿè´£å­ç³»ç»Ÿå¼€å‘ï¼›æ€§èƒ½ä¼˜åŒ–ï¼›ç¼ºé™·ä¿®å¤ä¸ä¼˜åŒ–</p>
    </div>
    
    <button onclick="startMainQuiz()">è¿›å…¥ç¬¬å››å¹´å·¥ä½œ</button>
</div>
                
       

            <div class="section" id="quiz-intro">
                <h2>æ‚¨çš„å·¥ä½œå†ç¨‹ï¼ˆç¬¬4å¹´ï¼‰</h2>
                
                <table class="level-table">
                    <tr>
                        <th>èŒçº§</th>
                        <th>èŒä½åç§°</th>
                        <th>å…¸å‹èŒè´£</th>
                        <th>ä»»èŒå¹´é™è¦æ±‚</th>
                    </tr>
                    <tr>
                        <td>L1</td>
                        <td>åˆçº§å·¥ç¨‹å¸ˆ</td>
                        <td>åŸºç¡€æ¨¡å—å¼€å‘ï¼›ä»£ç ç»´æŠ¤ï¼›æ•°æ®å¤„ç†ä¸æµ‹è¯•</td>
                        <td>1-3å¹´</td>
                    </tr>
                    <tr class="highlight">
                        <td>L2</td>
                        <td>ä¸­çº§å·¥ç¨‹å¸ˆ</td>
                        <td>ç‹¬ç«‹è´Ÿè´£å­ç³»ç»Ÿå¼€å‘ï¼›æ€§èƒ½ä¼˜åŒ–ï¼›ç¼ºé™·ä¿®å¤ä¸ä¼˜åŒ–</td>
                        <td>2-4å¹´</td>
                    </tr>
                    <tr>
                        <td>L3</td>
                        <td>é«˜çº§å·¥ç¨‹å¸ˆ</td>
                        <td>ä¸»å¯¼ç®—æ³•è®¾è®¡ï¼›è·¨å›¢é˜Ÿåä½œï¼›æ¨¡å‹éƒ¨ç½²ä¸è§„æ¨¡åŒ–åº”ç”¨</td>
                        <td>3-5å¹´</td>
                    </tr>
                    <tr>
                        <td>L4</td>
                        <td>ä¸“å®¶å·¥ç¨‹å¸ˆ</td>
                        <td>å¤æ‚é—®é¢˜è§£å†³ï¼›æ¶æ„è®¾è®¡ï¼›æŒ‡å¯¼åˆçº§å·¥ç¨‹å¸ˆ</td>
                        <td>4-6å¹´</td>
                    </tr>
                    <tr>
                        <td>L5</td>
                        <td>èµ„æ·±ä¸“å®¶å·¥ç¨‹å¸ˆ</td>
                        <td>åˆ¶å®šæˆ˜ç•¥ç ”å‘æ–¹å‘ï¼›å®ç°èƒ½å¸¦æ¥æ˜¾è‘—æˆæ•ˆçš„ä¼˜åŒ–ï¼›æä¾›æŠ€æœ¯å‘å±•è·¯çº¿çš„å»ºè®®</td>
                        <td>6-8å¹´</td>
                    </tr>
                    <tr>
                        <td>L6</td>
                        <td>é¦–å¸­ä¸“å®¶</td>
                        <td>å…¨å…¬å¸æŠ€æœ¯é¢†å¯¼åŠ›ï¼›å‰æ²¿åˆ›æ–°</td>
                        <td>7-10å¹´</td>
                    </tr>
                    <tr>
                        <td>L7</td>
                        <td>æŠ€æœ¯æ€»ç›‘</td>
                        <td>é«˜ç®¡å±‚å†³ç­–ï¼›ä½¿æŠ€æœ¯ä¸ä¸šåŠ¡å¤§æ–¹å‘å¯¹é½ï¼›é•¿æœŸæˆ˜ç•¥æ„¿æ™¯</td>
                        <td>>10å¹´</td>
                    </tr>
                </table>
                
                <div class="info-box">
    <p style="color: #333;">è¿›å…¥ç¬¬å››å¹´ï¼Œæ‚¨å‡­å€Ÿè¿‡ç¡¬çš„æŠ€æœ¯å®åŠ›åœ¨å›¢é˜Ÿä¸­è„±é¢–è€Œå‡ºã€‚ç°åœ¨ï¼Œå…¬å¸è€ƒè™‘å°†ä¸€ä¸ªå…³ä¹æœªæ¥å¸‚åœºåœ°ä½çš„æ ¸å¿ƒé¡¹ç›®â€”â€”<strong style="color: #2a5298;">æ”»å…‹è½¦è¾†è½¨è¿¹é¢„æµ‹ç®—æ³•çš„ç²¾å‡†åº¦é—®é¢˜</strong>â€”â€”æ­£å¼äº¤åˆ°æ‚¨çš„æ‰‹ä¸Šã€‚</p>
    <p style="color: #333; font-weight: bold;">è¿™ä¸ä»…æ˜¯å¯¹æ‚¨å§”ä»¥é‡ä»»ï¼Œæ›´æ˜¯å¯¹æ‚¨æŠ€æœ¯èƒ½åŠ›çš„æå¤§è€ƒéªŒã€‚é¡¹ç›®çš„æˆè´¥ï¼Œå°†ç›´æ¥å½±å“å…¬å¸åœ¨æ™ºèƒ½é©¾é©¶é¢†åŸŸçš„è¡Œä¸šç«äº‰åŠ›ã€‚</p>
</div>

<div class="info-box" style="border-left-color: #e91e63; margin-top: 30px;">
    <h3 style="font-size: 22px; color: #333;">æ–°çš„æ ¸å¿ƒä»»åŠ¡</h3>
    <p style="font-size: 18px; line-height: 1.8;">å‡­å€Ÿæ‚¨åœ¨ç¬¬ä¸‰å¹´çš„å‡ºè‰²è¡¨ç°ï¼Œå…¬å¸å†³å®šå°†è¿™ä¸€æ ¸å¿ƒé¡¹ç›®â€”â€”<strong style="color: #2a5298;">â€œæ”»å…‹è½¦è¾†è½¨è¿¹é¢„æµ‹ç®—æ³•çš„ç²¾å‡†åº¦é—®é¢˜â€</strong>â€”â€”æ­£å¼äº¤ç”±æ‚¨è´Ÿè´£ï¼</p>
</div>

                <button onclick="startQuiz()">å¼€å§‹ä»»åŠ¡</button>
            </div>

            <div class="section" id="quiz">
                <div class="quiz-status">
                    <span>ä»»åŠ¡ <span id="current-question">1</span> / 10</span>
                    <span>ç¬¬4å¹´å·¥ä½œè¿›åº¦</span>
                </div>
                <div class="quiz-progress">
                    <div class="quiz-progress-fill" id="progress-fill" style="width: 10%"></div>
                </div>
                
                <div id="question-container"></div>
                <div class="button-group" id="quiz-options"></div>
                <button id="next-question-btn" onclick="nextQuestion()" style="display: none; margin-top: 20px;">ä¸‹ä¸€ä¸ªä»»åŠ¡</button>
            </div>

          <div class="section" id="quiz-result">
    <h2>å¹´åº¦èŒçº§è€ƒæ ¸</h2>
    <div class="info-box">
        <p style="font-size: 20px; line-height: 1.8;">ç»è¿‡è¿™ä¸€å¹´çš„ä¸æ‡ˆåŠªåŠ›ï¼Œæ‚¨ç»ˆäºæ”»å…‹äº†è½¦è¾†è½¨è¿¹é¢„æµ‹ç®—æ³•çš„ç²¾å‡†åº¦éš¾é¢˜ï¼Œå®Œæˆäº†è¿™ä¸ªè‡³å…³é‡è¦çš„é¡¹ç›®ï¼<br><br>è§£å†³äº†å…³é”®æŠ€æœ¯é—®é¢˜åï¼Œé¡¹ç›®çš„æˆè´¥å°†å–å†³äºå¸‚åœºåé¦ˆã€‚</p>
        <p style="font-size: 20px; font-weight: bold; margin-top: 15px;">åœ¨ç­‰å¾…é¡¹ç›®æˆæœçš„å¸‚åœºåé¦ˆçš„åŒæ—¶ï¼Œæ–°ä¸€å¹´çš„èŒçº§è¯„ä¼°è€ƒæ ¸ä¹Ÿå·²åˆ°æ¥â€¦â€¦</p>
    </div>
    <button id="continue-btn" onclick="proceedAfterQuiz()">æŸ¥çœ‹è€ƒæ ¸ç»“æœ</button>
</div>

           <div class="section" id="promotion-decision" style="background: linear-gradient(135deg, #fffde7 0%, #fff8e1 100%); border-radius: 0 0 20px 20px;">
    <div id="celebration"></div>
    <h2>å…¬å¸å†³å®š</h2>
    <div id="promotion-content"></div>
    <div id="promotion-question-container"></div> 
</div>

<div class="section" id="pre-mystery-note">
    <h2>èŒ¶æ°´é—´çš„è®®è®º</h2>
    <div class="info-box" style="font-size: 27px; line-height: 1.8;">
        <p>æ¯å¹´èŒçº§è€ƒæ ¸ç»“æŸï¼Œå…¬å¸é‡Œæ€»ä¼šå¼¥æ¼«ç€å„ç§è®®è®ºã€‚</p>
        <p>èŒ¶æ°´é—´é‡Œï¼Œæœ‰äººä½å£°æ„Ÿå¹ï¼šâ€œä»–è¿™æ¬¡å‡å¾—æŒºå®è‡³åå½’ï¼Œä»–çš„é¡¹ç›®åšå¾—ç¡®å®ä¸é”™ã€‚â€ä¹Ÿæœ‰äººæ‘‡å¤´è¯´ï¼šâ€œä¸è¿‡å¥¹æ€ä¹ˆä¼šæ²¡è¿‡å‘¢ï¼Ÿå¥¹æœ€è¿‘çš„ä¸šç»©ä¹Ÿä¸å·®å•Šã€‚â€</p>
        <p>æµè¨€èœšè¯­åœ¨äººç¾¤ä¸­æ‰©æ•£ç€ï¼Œå¸¦æ¥äº†å¥½å¥‡ã€ç¾¡æ…•ï¼Œä¹Ÿæœ‰éšéšçš„ä¸æ»¡ã€‚</p>
        <p style="font-weight: bold; margin-top: 20px;">åœ¨è¿™æ ·çš„æ°›å›´ä¸­ï¼Œæ‚¨æ„å¤–çœ‹åˆ°äº†äººåŠ›èµ„æºéƒ¨çš„èŠå¤©è®°å½•â€¦â€¦</p>
    </div>
    <button onclick="showMysteryNote()">æŸ¥çœ‹èŠå¤©è®°å½•</button>
</div>
            <div class="section" id="mystery-note">
                <div class="mysterious-box">
                    <h2>ğŸ“‹ æ„å¤–å‘ç°</h2>
                    <p style="opacity: 0.7; margin-bottom: 20px;">æ‚¨å¶ç„¶çœ‹åˆ°äº†äººåŠ›èµ„æºéƒ¨çš„èŠå¤©è®°å½•...</p>
                    <div id="chat-display" style="display: none;"></div>
                    <button id="continue-after-mystery" onclick="showSurvey()" style="display: none; margin-top: 30px;">ç»§ç»­</button>
                </div>
            </div>

 <div class="section" id="survey">
    <h2>å½“å‰æ„Ÿå—è¯„ä¼°</h2>

    <div class="info-box">
        <p>ä¸€æ¬¡æ™‹å‡å¯èƒ½ä¼šç»™å‘˜å·¥å¸¦æ¥è®¸å¤šæ–°çš„æ„Ÿå—ä¸æƒ³æ³•ã€‚æˆ‘ä»¬éå¸¸å¸Œæœ›äº†è§£æ‚¨åœ¨ç»å†äº†æœ¬æ¬¡æ™‹å‡åçš„çœŸå®æ„Ÿå—ã€‚</p>
        <p style="font-weight: bold;">æ‚¨çš„å›ç­”æ²¡æœ‰å¯¹é”™ä¹‹åˆ†ï¼Œè¯·å®Œå…¨æŒ‰ç…§æ‚¨æ­¤åˆ»æœ€çœŸå®çš„æƒ³æ³•è¿›è¡Œè¯„åˆ†ã€‚</p>
    </div>
    
<h3 style="margin-top: 30px;">ç¬¬ä¸€éƒ¨åˆ†ï¼šç»è¿‡è¿™æ¬¡æ™‹å‡ï¼Œæ‚¨ä¼šåœ¨å¤šå¤§ç¨‹åº¦ä¸ŠåŒæ„ä»¥ä¸‹è¯´æ³•ï¼š</h3>
    <div id="rule-items"></div>
    
    <h3 style="margin-top: 30px;">ç¬¬äºŒéƒ¨åˆ†ï¼šç»è¿‡è¿™æ¬¡æ™‹å‡ï¼Œæ‚¨ä¼šåœ¨å¤šå¤§ç¨‹åº¦ä¸ŠåŒæ„ä»¥ä¸‹è¯´æ³•ï¼š</h3>
    <div id="reciprocal-items"></div>

    <h3 style="margin-top: 30px;">ç¬¬ä¸‰éƒ¨åˆ†ï¼šç»è¿‡è¿™æ¬¡æ™‹å‡ï¼Œæ‚¨ä¼šåœ¨å¤šå¤§ç¨‹åº¦ä¸ŠåŒæ„ä»¥ä¸‹è¯´æ³•ï¼š</h3>
    <div id="entitlement-items-moved"></div>

<div id="entitlement-items-moved"></div>

    <h3 style="margin-top: 30px;">ç¬¬å››éƒ¨åˆ†ï¼šç»è¿‡è¿™æ¬¡æ™‹å‡ï¼Œæ‚¨ä¼šåœ¨å¤šå¤§ç¨‹åº¦ä¸ŠåŒæ„ä»¥ä¸‹è¯´æ³•ï¼š</h3>
    <div id="moral-identity-items"></div>

    <h3 style="margin-top: 30px;">ç¬¬äº”éƒ¨åˆ†ï¼šç»è¿‡è¿™æ¬¡æ™‹å‡ï¼Œæ‚¨ä¼šåœ¨å¤šå¤§ç¨‹åº¦ä¸ŠåŒæ„ä»¥ä¸‹è¯´æ³•ï¼š</h3>
    <div id="imposter-items"></div>

    <h3 style="margin-top: 30px;">ç¬¬å…­éƒ¨åˆ†ï¼šç»è¿‡è¿™æ¬¡æ™‹å‡ï¼Œæ‚¨ä¼šåœ¨å¤šå¤§ç¨‹åº¦ä¸ŠåŒæ„ä»¥ä¸‹è¯´æ³•ï¼š</h3>
    <div id="pride-items"></div>

    <h3 style="margin-top: 30px;">ç¬¬ä¸ƒéƒ¨åˆ†ï¼šç»è¿‡è¿™æ¬¡æ™‹å‡ï¼Œæ‚¨ä¼šåœ¨å¤šå¤§ç¨‹åº¦ä¸ŠåŒæ„ä»¥ä¸‹è¯´æ³•ï¼š</h3>
    <div id="accomplishment-items"></div>

    <h3 style="margin-top: 30px;">ç¬¬å…«éƒ¨åˆ†ï¼šç»è¿‡è¿™æ¬¡æ™‹å‡ï¼Œæ‚¨ä¼šåœ¨å¤šå¤§ç¨‹åº¦ä¸ŠåŒæ„ä»¥ä¸‹è¯´æ³•ï¼š</h3>
<div id="thriving-items"></div>

<h3 style="margin-top: 30px;">ç¬¬ä¹éƒ¨åˆ†ï¼šç»è¿‡è¿™æ¬¡æ™‹å‡ï¼Œä»Šååœ¨å…¬å¸å¼€å±•ä»¥ä¸‹å·¥ä½œæ—¶ï¼Œä½ è§‰å¾—è‡ªå·±æœ‰å¤šè‡ªä¿¡ï¼Ÿ</h3>
    <div id="rbse-items"></div>
    
    <h3 style="margin-top: 30px;">ç¬¬åéƒ¨åˆ†ï¼šç»è¿‡è¿™æ¬¡æ™‹å‡ï¼Œæ‚¨ä¼šåœ¨å¤šå¤§ç¨‹åº¦ä¸ŠåŒæ„ä»¥ä¸‹è¯´æ³•ï¼š</h3>
    <div id="risk-items-moved"></div>
    <div id="survey-error" class="error-hint" style="text-align: center; margin-bottom: 15px; font-size: 16px;"></div>

    <div id="survey-error" class="error-hint" style="text-align: center; margin-bottom: 15px; font-size: 16px;"></div>
    <button onclick="submitSurvey()">æäº¤å¹¶ç»§ç»­å®éªŒ</button>
</div>


<div class="section" id="pre-scenarios">
                <div class="transition-page">
                    <div class="transition-box" style="background: linear-gradient(135deg, #f5f7fa 0%, #e9eef3 100%);">
                        <h2 style="color: #000; font-size: 48px; text-shadow: 1px 1px 3px rgba(0,0,0,0.1);" class="title-flash-animation">
                            æ–°çš„å·¥ä½œæŒ‘æˆ˜
                        </h2>
                        <p style="font-size: 24px; margin: 20px 0; color: #000; font-weight: bold;">
                            å†æ¬¡æ­å–œæ‚¨æˆåŠŸæ™‹å‡ï¼<br>å¯¹æ‚¨æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªé‡è¦çš„æˆå°±å’Œé‡Œç¨‹ç¢‘ã€‚
                        </p>
                        <p style="font-size: 27px; margin: 20px 0; color: #000;">
                            ä¸æ­¤åŒæ—¶ï¼Œåœ¨æ–°çš„å²—ä½ä¸Šä¹Ÿæœ‰ä¸€äº›æ–°çš„ä»»åŠ¡ç­‰å¾…æ‚¨å»è§£å†³ã€‚<br>
                            æ‚¨ä¼šé‡åˆ°ä¸€ç³»åˆ—éœ€è¦æ‚¨åšå‡ºå†³ç­–çš„çœŸå®é—®é¢˜ã€‚
                        </p>
                        <p style="margin-top: 20px; color: #000; font-size: 27px;">
                            è¯·å®Œå…¨æŒ‰ç…§æ‚¨å†…å¿ƒæœ€çœŸå®çš„æƒ³æ³•è¿›è¡Œé€‰æ‹©ã€‚
                        </p>
                        <p style="font-weight: bold; margin-top: 10px; color: #c0392b; font-size: 30px;">
                            æ‰€æœ‰é€‰é¡¹æ²¡æœ‰å¯¹é”™ä¹‹åˆ†ã€‚
                        </p>
                    </div>
                </div>
                <button onclick="loadManagementScenario()">å¼€å§‹æŒ‘æˆ˜</button>
            </div>


               <div class="section" id="management-scenarios">
                <h2>æ–°å²—ä½å·¥ä½œåœºæ™¯</h2>
                <div id="scenario-content"></div>
                <div class="button-group" id="scenario-options"></div>
            </div>


            <div class="section" id="post-scenario-survey">
                <h2>å·¥ä½œè¡Œä¸ºè¯„ä¼°</h2>
                <div class="info-box">
                    <p>æ‚¨å·²ç»å®Œæˆäº†æ‰€æœ‰å·¥ä½œåœºæ™¯ã€‚æ¥ä¸‹æ¥ï¼Œè¯·æ ¹æ®æ‚¨çš„çœŸå®æ„Ÿå—å’Œæƒ³æ³•ï¼Œå¯¹ä»¥ä¸‹é™ˆè¿°è¿›è¡Œè¯„åˆ†ã€‚</p>
                    <p style="font-weight: bold;">æ‚¨çš„å›ç­”æ²¡æœ‰å¯¹é”™ä¹‹åˆ†ï¼Œè¯·å®Œå…¨æŒ‰ç…§æ‚¨çš„çœŸå®æƒ³æ³•è¿›è¡Œè¯„åˆ†ã€‚</p>
                </div>
                
               <h3 style="margin-top: 30px;">ç¬¬ä¸€éƒ¨åˆ†ï¼šåœ¨ä»Šåçš„å·¥ä½œä¸­ï¼Œæ‚¨æœ‰å¤šå¤§å¯èƒ½æ€§ä¼šè¡¨ç°å‡ºä»¥ä¸‹è¡Œä¸ºï¼š</h3>
                <div id="deception-items"></div>

                <h3 style="margin-top: 30px;">ç¬¬äºŒéƒ¨åˆ†ï¼šåœ¨ä»Šåçš„å·¥ä½œä¸­ï¼Œæ‚¨æœ‰å¤šå¤§å¯èƒ½æ€§ä¼šè¡¨ç°å‡ºä»¥ä¸‹è¡Œä¸ºï¼š</h3>
                <div id="cwb-items"></div>

                <h3 style="margin-top: 30px;">ç¬¬ä¸‰éƒ¨åˆ†ï¼šåœ¨ä»Šåçš„å·¥ä½œä¸­ï¼Œæ‚¨æœ‰å¤šå¤§å¯èƒ½æ€§ä¼šè¡¨ç°å‡ºä»¥ä¸‹è¡Œä¸ºï¼š</h3>
                <div id="voice-items"></div>

                <h3 style="margin-top: 30px;">ç¬¬å››éƒ¨åˆ†ï¼šåœ¨ä»Šåçš„å·¥ä½œä¸­ï¼Œæ‚¨æœ‰å¤šå¤§å¯èƒ½æ€§ä¼šè¡¨ç°å‡ºä»¥ä¸‹è¡Œä¸ºï¼š</h3>
                <div id="taking-charge-items"></div>

                <div id="post-survey-error" class="error-hint" style="text-align: center; margin-bottom: 15px; font-size: 16px;"></div>
                <button onclick="submitPostSurvey()">æäº¤å¹¶ç»§ç»­</button>
            </div>

            <div class="section" id="pre-demographics">
                <div class="transition-page">
                    <div class="transition-box">
                        <h2>åœºæ™¯ä»»åŠ¡å®Œæˆ</h2>
                        <p style="font-size: 18px; margin: 20px 0;">
                            æ‚¨å·²ç»å®Œæˆäº†æ‰€æœ‰çš„å·¥ä½œåœºæ™¯å†³ç­–ï¼
                        </p>
                        <p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦æ”¶é›†ä¸€äº›åŸºæœ¬ä¿¡æ¯ã€‚</p>
                        <p style="font-weight: bold; margin-top: 20px;">
                            è¯·æ ¹æ®æ‚¨çš„å®é™…æƒ…å†µå¦‚å®å¡«å†™ã€‚<br>
                            æ‰€æœ‰ä¿¡æ¯ä»…ç”¨äºå­¦æœ¯ç ”ç©¶ï¼Œæˆ‘ä»¬å°†ä¸¥æ ¼ä¿å¯†ã€‚
                        </p>
                    </div>
                </div>
                <button onclick="loadAndGoToDemographics()">ç»§ç»­</button>
            </div>

         
<div class="section" id="demographics">
    <h2>åŸºæœ¬ä¿¡æ¯è°ƒæŸ¥</h2>
    <p>è¯·å¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼Œæ‰€æœ‰ä¿¡æ¯å°†ä¸¥æ ¼ä¿å¯†ï¼š</p>
    
    <div class="form-group">
        <label>æ€§åˆ«ï¼š</label>
        <div class="radio-group">
            <label class="radio-option">
                <input type="radio" name="gender" value="ç”·"> ç”·
            </label>
            <label class="radio-option">
                <input type="radio" name="gender" value="å¥³"> å¥³
            </label>
        </div>
    </div>

    <div class="form-group">
        <label>å¹´é¾„ï¼š</label>
        <select id="age-select">
            <option value="">è¯·é€‰æ‹©æ‚¨çš„å¹´é¾„æ®µ...</option>
            <option value="18-25">18-25å²</option>
            <option value="26-35">26-35å²</option>
            <option value="36-45">36-45å²</option>
            <option value="46-55">46-55å²</option>
            <option value="56+">56å²åŠä»¥ä¸Š</option>
        </select>
    </div>

    <div class="form-group">
        <label>æ•™è‚²ç¨‹åº¦ï¼š</label>
        <div class="radio-group">
            <label class="radio-option"><input type="radio" name="education" value="åˆä¸­/ä¸­ä¸“åŠä»¥ä¸‹"> åˆä¸­/ä¸­ä¸“åŠä»¥ä¸‹</label>
            <label class="radio-option"><input type="radio" name="education" value="é«˜ä¸­/å¤§ä¸“"> é«˜ä¸­/å¤§ä¸“</label>
            <label class="radio-option"><input type="radio" name="education" value="æœ¬ç§‘"> æœ¬ç§‘</label>
            <label class="radio-option"><input type="radio" name="education" value="ç¡•å£«"> ç¡•å£«</label>
            <label class="radio-option"><input type="radio" name="education" value="åšå£«åŠä»¥ä¸Š"> åšå£«åŠä»¥ä¸Š</label>
        </div>
    </div>

    <div class="form-group">
        <label>åœ¨å½“å‰ç»„ç»‡çš„å·¥ä½œå¹´é™ï¼š</label>
        <div class="radio-group">
            <label class="radio-option"><input type="radio" name="experience" value="<1"> 1å¹´ä»¥ä¸‹</label>
            <label class="radio-option"><input type="radio" name="experience" value="1-3"> 1-3å¹´</label>
            <label class="radio-option"><input type="radio" name="experience" value="4-6"> 4-6å¹´</label>
            <label class="radio-option"><input type="radio" name="experience" value="7-10"> 7-10å¹´</label>
            <label class="radio-option"><input type="radio" name="experience" value="10+"> 10å¹´ä»¥ä¸Š</label>
        </div>
    </div>
    
    <div class="form-group">
        <label>æ‚¨å¯¹è½¦è¾†æ™ºèƒ½é©¾é©¶ç³»ç»Ÿçš„ä½¿ç”¨ç»éªŒå¦‚ä½•ï¼Ÿ</label>
        <div class="likert-scale">
            <label class="likert-option"><input type="radio" name="smart-driving" value="1" class="likert-radio"><span class="likert-label">1<br>å®Œå…¨æ²¡æœ‰<br>ä½¿ç”¨è¿‡</span></label>
            <label class="likert-option"><input type="radio" name="smart-driving" value="2" class="likert-radio"><span class="likert-label">2<br>å¾ˆå°‘<br>ä½¿ç”¨</span></label>
            <label class="likert-option"><input type="radio" name="smart-driving" value="3" class="likert-radio"><span class="likert-label">3<br>å¶å°”<br>ä½¿ç”¨</span></label>
            <label class="likert-option"><input type="radio" name="smart-driving" value="4" class="likert-radio"><span class="likert-label">4<br>ç»å¸¸<br>ä½¿ç”¨</span></label>
            <label class="likert-option"><input type="radio" name="smart-driving" value="5" class="likert-radio"><span class="likert-label">5<br>éå¸¸ç†Ÿæ‚‰<br>ä¸”å¸¸ç”¨</span></label>
        </div>
    </div>

    <div class="form-group">
        <label>æ‚¨çš„ç®—æ³•ç›¸å…³å·¥ä½œæˆ–å­¦ä¹ ç»å†æœ‰å¤šä¸°å¯Œï¼Ÿ</label>
        <div class="likert-scale">
            <label class="likert-option"><input type="radio" name="algorithm-exp" value="1" class="likert-radio"><span class="likert-label">1<br>å®Œå…¨æ²¡æœ‰<br>ç›¸å…³ç»å†</span></label>
            <label class="likert-option"><input type="radio" name="algorithm-exp" value="2" class="likert-radio"><span class="likert-label">2<br>ç•¥æœ‰<br>äº†è§£</span></label>
            <label class="likert-option"><input type="radio" name="algorithm-exp" value="3" class="likert-radio"><span class="likert-label">3<br>æœ‰ä¸€å®š<br>ç»éªŒ</span></label>
            <label class="likert-option"><input type="radio" name="algorithm-exp" value="4" class="likert-radio"><span class="likert-label">4<br>ç»éªŒ<br>è¾ƒä¸°å¯Œ</span></label>
            <label class="likert-option"><input type="radio" name="algorithm-exp" value="5" class="likert-radio"><span class="likert-label">5<br>ä¸“å®¶/èµ„æ·±<br>ä»ä¸šè€…</span></label>
        </div>
    </div>

    <div class="form-group" style="margin-top: 40px; padding-top: 20px; border-top: 2px solid #eee;">
        <label>æœ€åè¯·ç¡®è®¤ï¼šæ‚¨æ˜¯å¦ç†è§£äº†æœ¬å®éªŒä¸­çš„æ‰€æœ‰é˜…è¯»ææ–™ã€é¢˜ç›®ä»¥åŠé€‰é¡¹ï¼Ÿ</label>
        <div class="likert-scale">
            <label class="likert-option"><input type="radio" name="understanding" value="1" class="likert-radio"><span class="likert-label">1<br>å®Œå…¨ä¸ç†è§£</span></label>
            <label class="likert-option"><input type="radio" name="understanding" value="2" class="likert-radio"><span class="likert-label">2</span></label>
            <label class="likert-option"><input type="radio" name="understanding" value="3" class="likert-radio"><span class="likert-label">3</span></label>
            <label class="likert-option"><input type="radio" name="understanding" value="4" class="likert-radio"><span class="likert-label">4<br>ä¸ç¡®å®š</span></label>
            <label class="likert-option"><input type="radio" name="understanding" value="5" class="likert-radio"><span class="likert-label">5</span></label>
            <label class="likert-option"><input type="radio" name="understanding" value="6" class="likert-radio"><span class="likert-label">6</span></label>
            <label class="likert-option"><input type="radio" name="understanding" value="7" class="likert-radio"><span class="likert-label">7<br>å®Œå…¨ç†è§£</span></label>
        </div>
    </div>
    <div id="demographics-error" class="error-hint" style="text-align: center; margin-bottom: 15px; font-size: 16px;"></div>
    
    <button onclick="finishExperiment()">æäº¤å¹¶å®Œæˆ</button>
</div>


            <div class="section" id="complete">
                <h2>æ­£åœ¨æäº¤æ•°æ®...</h2>
                <div class="info-box">
                    <div style="text-align: center;">
                        <div class="loading-spinner"></div>
                        <p>è¯·ç¨å€™ï¼Œæ­£åœ¨å®‰å…¨ä¿å­˜æ‚¨çš„æ•°æ®...</p>
                        <p style="color: #666; font-size: 14px;">è¯·å‹¿å…³é—­é¡µé¢</p>
                    </div>
                </div>
            </div>

            <div class="section" id="thank-you">
                <div class="thank-you-box">
                    <h2>ğŸŒŸ æ„Ÿè°¢æ‚¨çš„å‚ä¸ï¼</h2>
                    <p>æ‚¨å·²æˆåŠŸå®Œæˆæœ¬æ¬¡å®éªŒç ”ç©¶</p>
                    <p style="font-size: 16px; margin-top: 30px; opacity: 0.9;">
                        æ‚¨çš„å®è´µæ„è§å¯¹æˆ‘ä»¬çš„ç ”ç©¶è‡³å…³é‡è¦<br>
                        æ‚¨çš„å‚ä¸å°†ä¸ºç»„ç»‡è¡Œä¸ºå­¦çš„å‘å±•åšå‡ºé‡è¦è´¡çŒ®
                    </p>
                </div>
                <div class="info-box" style="text-align: center; margin-top: 30px;">
                    <p style="font-size: 16px;">
                        <strong>æ‚¨çš„å‚ä¸è€…ç¼–å·ï¼š</strong><br>
                        <span id="participant-id-display" style="font-size: 20px; color: #2a5298; font-weight: bold;"></span>
                    </p>
                    <p style="color: #666; font-size: 14px; margin-top: 20px;">
                        å¦‚æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯·å‡­æ­¤ç¼–å·ä¸ç ”ç©¶å›¢é˜Ÿè”ç³»<br>
                        å†æ¬¡æ„Ÿè°¢æ‚¨çš„æ”¯æŒä¸é…åˆï¼
                    </p>
                    <p style="margin-top: 30px; font-size: 18px;">
                        ç¥æ‚¨ç”Ÿæ´»æ„‰å¿«ï¼
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
// LeanCloud åˆå§‹åŒ–
AV.init({
    appId: "UAoeCrbeqysPGyrbgMKFmQbP-gzGzoHsz",
    appKey: "mKmOYdptYxijA0hoqqFO0Z7x",
    serverURL: "https://uaoecrbe.lc-cn-n1-shared.com"
});

// åˆå§‹åŒ–å…¨å±€çŠ¶æ€
window.gameState = {
    currentSection: 'welcome',
    navigationHistory: [],
    yearTasks: [],
    currentYearTask: 0,
    yearTaskAnswers: [],
    quizQuestions: [],
    currentQuestionIndex: 0,
    correctAnswers: 0,
    quizAnswers: [],
    quizCompleted: false,
    promotionType: '', 
    promotionLevel: '',
    promotionUnderstanding: '',
    promotionReason: '', 
    mysteryReason: '',
    surveyData: { reciprocal: [], rule: [] },
    behaviorData: { reciprocal: [], rule: [] },
    behaviorScores: { reciprocal: 0, rule: 0 },
    currentScenario: 0,
    scenariosCompleted: false,
    postScenarioSurveyData: {},
    demographics: {},
    personalityData: { honesty: [], entitlement: [] },
    startTime: new Date(),
    endTime: null,
    participantId: ''
};

const scalesAgreement = ['å®Œå…¨ä¸åŒæ„', 'ä¸åŒæ„', 'æœ‰ç‚¹ä¸åŒæ„', 'ä¸­ç«‹', 'æœ‰ç‚¹åŒæ„', 'åŒæ„', 'å®Œå…¨åŒæ„'];


const yearTasks = [
    { date: "ç¬¬3å¹´1æœˆ", context: "æ‚¨è´Ÿè´£çš„è½¦è¾†æ•°æ®é¢„å¤„ç†æ¨¡å—å‡ºç°äº†ä¸€ä¸ªå°æ¼æ´ï¼Œå¯¼è‡´éƒ¨åˆ†æ•°æ®æ ¼å¼ä¸ä¸€è‡´ã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["ç«‹å³ä¿®å¤æ¼æ´å¹¶æ›´æ–°æ–‡æ¡£", "æš‚æ—¶å¿½ç•¥ï¼Œç­‰ç´¯ç§¯æ›´å¤šé—®é¢˜ä¸€èµ·å¤„ç†", "è®©å®ä¹ ç”Ÿå»å¤„ç†", "æ¨ç»™å…¶ä»–æ¨¡å—è´Ÿè´£äºº"], correct: 0 },
    { date: "ç¬¬3å¹´3æœˆ", context: "å›¢é˜Ÿéœ€è¦å¯¹ç°æœ‰çš„æµ‹è¯•æ¡†æ¶è¿›è¡Œå‡çº§ï¼Œæ‚¨è¢«åˆ†é…è´Ÿè´£ç¼–å†™æ–°çš„æµ‹è¯•ç”¨ä¾‹ã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["å‚è€ƒä¸šç•Œæœ€ä½³å®è·µç¼–å†™å…¨é¢çš„æµ‹è¯•ç”¨ä¾‹", "éšä¾¿å†™å‡ ä¸ªåº”ä»˜äº†äº‹", "å¤åˆ¶æ—§çš„æµ‹è¯•ç”¨ä¾‹ç¨ä½œä¿®æ”¹", "è¯´è‡ªå·±ä¸ä¼šï¼Œæ¨ç»™åˆ«äºº"], correct: 0 },
    { date: "ç¬¬3å¹´5æœˆ", context: "ä»£ç å®¡æŸ¥æ—¶å‘ç°æ‚¨ç»´æŠ¤çš„æ¨¡å—æœ‰æ€§èƒ½ç“¶é¢ˆï¼Œéœ€è¦è¿›è¡Œä¼˜åŒ–ã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["ä¸ç®¡å®ƒï¼Œåæ­£èƒ½è¿è¡Œ", "ç®€å•è°ƒæ•´ä¸€ä¸‹å‚æ•°", "æ·±å…¥åˆ†æå¹¶é‡æ„å…³é”®ä»£ç ", "åˆ é™¤ä¸€äº›åŠŸèƒ½æ¥æå‡æ€§èƒ½"], correct: 2 },
    { date: "ç¬¬3å¹´7æœˆ", context: "æ–°é¡¹ç›®éœ€è¦é›†æˆä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œæ‚¨è´Ÿè´£è¯„ä¼°å’Œé›†æˆå·¥ä½œã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["éšä¾¿é€‰ä¸€ä¸ªçœ‹èµ·æ¥ä¸é”™çš„", "ä»”ç»†å¯¹æ¯”å¤šä¸ªé€‰é¡¹ï¼Œé€‰æ‹©æœ€é€‚åˆçš„", "è®©é¢†å¯¼å†³å®šç”¨å“ªä¸ª", "ç”¨è‡ªå·±ç†Ÿæ‚‰çš„ï¼Œä¸ç®¡åˆä¸åˆé€‚"], correct: 1 },
    { date: "ç¬¬3å¹´9æœˆ", context: "æ•°æ®å¤„ç†ç®¡é“å¶å°”ä¼šå‡ºç°æ•°æ®ä¸¢å¤±çš„æƒ…å†µï¼Œéœ€è¦æ’æŸ¥åŸå› ã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["è®¤ä¸ºæ˜¯æ­£å¸¸ç°è±¡ï¼Œä¸ç”¨ç®¡", "ç®€å•çœ‹çœ‹æ—¥å¿—ï¼Œæ‰¾ä¸åˆ°å°±ç®—äº†", "æ¨æµ‹å¯èƒ½çš„åŸå› ï¼Œéšä¾¿æ”¹æ”¹", "ç³»ç»Ÿæ€§åœ°æ’æŸ¥æ¯ä¸ªç¯èŠ‚ï¼Œæ‰¾å‡ºæ ¹æœ¬åŸå› "], correct: 3 },
    { date: "ç¬¬3å¹´11æœˆ", context: "å¹´åº•éœ€è¦æ•´ç†æŠ€æœ¯æ–‡æ¡£ï¼Œä¸ºæ–°å‘˜å·¥åŸ¹è®­åšå‡†å¤‡ã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["ç¼–å†™è¯¦ç»†æ¸…æ™°çš„æ–‡æ¡£ï¼ŒåŒ…å«ç¤ºä¾‹ä»£ç ", "ä»ç½‘ä¸Šå¤åˆ¶ä¸€äº›é€šç”¨æ–‡æ¡£", "å†™ä¸ªç®€å•å¤§çº²äº¤å·®", "è¯´å¤ªå¿™äº†ï¼Œæ²¡æ—¶é—´å†™"], correct: 0 },
    { date: "ç¬¬3å¹´12æœˆ", context: "å¹´åº¦æ€»ç»“æ—¶ï¼Œéœ€è¦å±•ç¤ºæ‚¨è¿™ä¸€å¹´çš„ä¸»è¦è´¡çŒ®å’Œæˆé•¿ã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["éšä¾¿å†™å†™ï¼Œåº”ä»˜äº†äº‹", "å¤¸å¤§è‡ªå·±çš„è´¡çŒ®", "åªåˆ—å‡ºåšè¿‡çš„äº‹ï¼Œä¸åšæ€»ç»“", "è®¤çœŸæ€»ç»“æŠ€æœ¯æˆé•¿å’Œå®é™…è´¡çŒ®"], correct: 3 }
];
const mainQuizQuestions = [
    { date: "ç¬¬4å¹´1æœˆ", context: "æ–°å¹´ä¼Šå§‹ï¼Œæ‚¨å¼€å§‹è´Ÿè´£è½¦è¾†è½¨è¿¹é¢„æµ‹ç®—æ³•é¡¹ç›®ã€‚é¦–å…ˆéœ€è¦æ­å»ºåŸºç¡€çš„å¼€å‘ç¯å¢ƒã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["ä½¿ç”¨æ ‡å‡†åŒ–çš„å°è£…æŠ€æœ¯ç¡®ä¿ç¯å¢ƒä¸€è‡´æ€§", "åœ¨è‡ªå·±ç”µè„‘ä¸Šéšä¾¿è£…ä¸€äº›è½¯ä»¶", "è®©åˆ«äººå¸®å¿™é…ç½®", "ç”¨å…¬å¸æ—§çš„ç¯å¢ƒå‡‘åˆ"], correct: 0, difficulty: "easy" },
    { date: "ç¬¬4å¹´2æœˆ", context: "è½¨è¿¹é¢„æµ‹ç®—æ³•éœ€è¦å¤„ç†å¤§é‡çš„ä¼ æ„Ÿå™¨æ•°æ®ï¼Œæ‚¨å‘ç°ç°æœ‰çš„æ•°æ®æ ¼å¼ä¸ç»Ÿä¸€ã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["å¿½ç•¥æ ¼å¼é—®é¢˜ï¼Œç›´æ¥ä½¿ç”¨", "æ‰‹åŠ¨è½¬æ¢æ¯æ‰¹æ•°æ®", "å¼€å‘ç»Ÿä¸€çš„æ•°æ®é¢„å¤„ç†æµç¨‹", "åªç”¨æ ¼å¼æ­£ç¡®çš„æ•°æ®"], correct: 2, difficulty: "easy" },
    { date: "ç¬¬4å¹´3æœˆ", context: "ç®—æ³•åœ¨ç›´é“é¢„æµ‹å‡†ç¡®ç‡è¾¾åˆ°85%ï¼Œä½†åœ¨å¤æ‚è·¯å£åªæœ‰60%ã€‚äº§å“ç»ç†è¯¢é—®æ”¹è¿›æ–¹æ¡ˆã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["å‘Šè¯‰äº§å“ç»ç†è¿™å·²ç»æ˜¯æé™äº†", "åˆ†æè·¯å£åœºæ™¯ç‰¹ç‚¹ï¼Œè®¾è®¡é’ˆå¯¹æ€§çš„æ”¹è¿›æ–¹æ¡ˆ", "å»ºè®®é™ä½è·¯å£åœºæ™¯çš„ä½¿ç”¨", "æŠŠè´£ä»»æ¨ç»™æ•°æ®è´¨é‡é—®é¢˜"], correct: 1, difficulty: "medium" },
    { date: "ç¬¬4å¹´4æœˆ", context: "æµ‹è¯•å‘ç°ç®—æ³•åœ¨é›¨å¤©åœºæ™¯ä¸‹æ€§èƒ½ä¸‹é™30%ï¼Œè¿™æ˜¯ä¹‹å‰æ²¡æœ‰è€ƒè™‘åˆ°çš„ã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["æ”¶é›†é›¨å¤©æ•°æ®ï¼Œé‡æ–°è®­ç»ƒæ¨¡å‹", "è¯´æ˜é›¨å¤©æœ¬æ¥å°±è¯¥æ€§èƒ½ä¸‹é™", "ç®€å•è°ƒæ•´é˜ˆå€¼åº”ä»˜", "å»ºè®®é›¨å¤©å…³é—­è¯¥åŠŸèƒ½"], correct: 0, difficulty: "easy" },
    { date: "ç¬¬4å¹´5æœˆ", context: "ç«äº‰å¯¹æ‰‹å‘å¸ƒäº†æ–°çš„è½¨è¿¹é¢„æµ‹æŠ€æœ¯ï¼Œå£°ç§°å‡†ç¡®ç‡æå‡15%ã€‚å›¢é˜Ÿå‹åŠ›å¾ˆå¤§ã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["ç ”ç©¶å¯¹æ‰‹çš„æŠ€æœ¯è®ºæ–‡ï¼Œåˆ†ææ”¹è¿›æ€è·¯", "è®¤ä¸ºå¯¹æ‰‹åœ¨å¤¸å¤§å®£ä¼ ", "ç»§ç»­æŒ‰åŸè®¡åˆ’å¼€å‘", "å»ºè®®å…¬å¸æŒ–å¯¹æ–¹çš„äºº"], correct: 0, difficulty: "easy" },
    { date: "ç¬¬4å¹´7æœˆ", context: "ç®—æ³•éœ€è¦åŒæ—¶å¤„ç†è½¦è¾†ã€è¡Œäººã€è‡ªè¡Œè½¦çš„è½¨è¿¹é¢„æµ‹ï¼Œè®¡ç®—èµ„æºä¸¥é‡ä¸è¶³ã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["è¦æ±‚å…¬å¸ä¹°æ›´å¤šæœåŠ¡å™¨", "å»æ‰ä¸€äº›é¢„æµ‹ç›®æ ‡", "ä¼˜åŒ–ç®—æ³•æ¶æ„ï¼Œæé«˜è®¡ç®—æ•ˆç‡", "é™ä½é¢„æµ‹ç²¾åº¦æ¢å–é€Ÿåº¦"], correct: 2, difficulty: "hard" },
    { date: "ç¬¬4å¹´8æœˆ", context: "å®¢æˆ·åé¦ˆåœ¨é«˜é€Ÿå…¬è·¯åœºæ™¯é¢„æµ‹ç»å¸¸å‡ºç°å¼‚å¸¸è·³å˜ï¼Œå½±å“é©¾é©¶ä½“éªŒã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["å¢åŠ å¹³æ»‘æ»¤æ³¢ç®€å•å¤„ç†", "æ·±å…¥åˆ†æå¼‚å¸¸æ¡ˆä¾‹ï¼Œä»æ ¹æœ¬ä¸Šè§£å†³", "è¯´è¿™æ˜¯æ­£å¸¸ç°è±¡", "è®©å®¢æˆ·é™ä½ä½¿ç”¨é¢‘ç‡"], correct: 1, difficulty: "easy" },
    { date: "ç¬¬4å¹´9æœˆ", context: "å…¬å¸è¦æ±‚åœ¨3ä¸ªæœˆå†…å°†é¢„æµ‹æ—¶é—´ä»3ç§’å»¶é•¿åˆ°5ç§’ï¼Œè¿™éœ€è¦é‡å¤§æŠ€æœ¯çªç ´ã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["ç›´æ¥è¯´åšä¸åˆ°", "ç®€å•å¤–æ¨ç°æœ‰é¢„æµ‹ç»“æœ", "ç ”ç©¶é•¿æ—¶é¢„æµ‹çš„æ–°æ–¹æ³•ï¼Œåˆ¶å®šæŠ€æœ¯è·¯çº¿", "ç­”åº”ä¸‹æ¥ä½†ä¸ä¸€å®šèƒ½å®Œæˆ"], correct: 2, difficulty: "hard" },
    { date: "ç¬¬4å¹´10æœˆ", context: "ç®—æ³•å‡†å¤‡éƒ¨ç½²åˆ°å®è½¦æµ‹è¯•ï¼Œéœ€è¦æ»¡è¶³è½¦è§„çº§çš„å®‰å…¨æ ‡å‡†ã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["æŒ‰ç…§å®‰å…¨æ ‡å‡†é€é¡¹æ£€æŸ¥å’Œæ”¹è¿›", "è®¤ä¸ºç®—æ³•æ²¡é—®é¢˜ï¼Œç›´æ¥éƒ¨ç½²", "ç®€å•æµ‹è¯•ä¸€ä¸‹å°±ä¸Šè½¦", "è®©æµ‹è¯•éƒ¨é—¨è´Ÿè´£å®‰å…¨é—®é¢˜"], correct: 0, difficulty: "easy" },
    { date: "ç¬¬4å¹´11æœˆ", context: "å¹´åº•é¡¹ç›®æ€»ç»“ï¼Œè½¨è¿¹é¢„æµ‹å‡†ç¡®ç‡æå‡äº†25%ï¼Œè¾¾åˆ°ä¸šç•Œå…ˆè¿›æ°´å¹³ã€‚", question: "æ‚¨çš„åšæ³•æ˜¯ï¼š", options: ["åªå¼ºè°ƒè‡ªå·±çš„è´¡çŒ®", "å®¢è§‚æ€»ç»“å›¢é˜Ÿåä½œå’ŒæŠ€æœ¯çªç ´", "è®¤ä¸ºè¿˜ä¸å¤Ÿå¥½ï¼Œä¸å€¼å¾—æ€»ç»“", "å¤¸å¤§æˆæœï¼Œäº‰å–æ›´å¤šå¥–åŠ±"], correct: 1, difficulty: "medium" }
];
const ruleItems = ["å…¬å¸é‡Œçš„è§„åˆ™æ˜¯å¯ä»¥è¢«æ‰“ç ´çš„ã€‚", "å¿…è¦çš„æ—¶å€™å¯ä»¥æ‰“ç ´å…¬å¸é‡Œçš„è§„åˆ™ã€‚", "æ‰“ç ´è§„åˆ™æ˜¯å¯ä»¥è¢«å…¬å¸æ‰€æ¥å—çš„ã€‚", "å¤„ç†ç‰¹æ®Šæƒ…å†µä¸éœ€è¦è€ƒè™‘æ˜¯å¦è¿èƒŒå…¬å¸é‡Œçš„è§„åˆ™ã€‚", "å…¬å¸é‡Œçš„è§„åˆ™åªé€‚ç”¨äºå¤§éƒ¨åˆ†äººï¼Œè€Œä¸æ˜¯æ‰€æœ‰äººã€‚", "å…¬å¸é‡Œçš„è§„åˆ™æ˜¯å¯ä»¥ä¸ºæŸäº›äººè€Œæ”¹å˜çš„ã€‚", "æŸäº›äººå¯ä»¥ä¸å—å…¬å¸è§„åˆ™çš„é™åˆ¶å’ŒæŸç¼šã€‚", "æœ‰å½±å“åŠ›çš„äººç”šè‡³å¯ä»¥æ”¹å˜å…¬å¸çš„è§„åˆ™ã€‚", "æ‰“ç ´è§„åˆ™ä¸ä¸€å®šä¼šå—åˆ°å…¬å¸çš„æƒ©ç½šã€‚", "æ‰“ç ´å…¬å¸é‡Œçš„è§„åˆ™ä¸ä¸€å®šä¼šå¸¦æ¥è´Ÿé¢ç»“æœã€‚"];
const reciprocalItems = ["æˆ‘è§‰å¾—æˆ‘æœ‰ä¹‰åŠ¡å°½æˆ‘æ‰€èƒ½å¸®åŠ©å…¬å¸å®ç°ç›®æ ‡ã€‚", "æˆ‘åœ¨å·¥ä½œä¸­åº”è¯¥ä¸ºå…¬å¸çš„ç›®æ ‡è´¡çŒ®100%çš„ç²¾åŠ›ã€‚", "æˆ‘æœ‰è´£ä»»ç¡®ä¿é«˜è´¨é‡åœ°å®Œæˆå·¥ä½œï¼Œè¿™æ˜¯æˆ‘å¯¹å…¬å¸åº”å°½çš„ä¹‰åŠ¡ã€‚", "æˆ‘æœ‰ä¹‰åŠ¡ç¡®ä¿å…¬å¸çš„å®¢æˆ·å¾—åˆ°å‘¨åˆ°çš„æœåŠ¡å’Œæ»¡æ„çš„ç»“æœï¼Œè¿™æ˜¯æˆ‘ä¸ºå…¬å¸åº”è¯¥åšçš„ã€‚", "å¦‚æœå…¬å¸éœ€è¦æˆ‘çš„å¸®åŠ©ï¼Œæˆ‘ä¼šè§‰å¾—æœ‰ä¹‰åŠ¡ä»æˆ‘çš„ä¸ªäººæ—¥ç¨‹ä¸­æŠ½å‡ºæ—¶é—´æ¥æ”¯æŒå•ä½ã€‚", "å¦‚æœæˆ‘æ²¡æœ‰è¾¾åˆ°å…¬å¸çš„ç»©æ•ˆæ ‡å‡†ï¼Œæˆ‘ä¼šæ„Ÿåˆ°å†…ç–šã€‚", "æˆ‘è®¤ä¸ºæˆ‘å¯¹å…¬å¸çš„è´£ä»»å°±æ˜¯å°½æˆ‘æ‰€èƒ½ï¼Œæ»¡è¶³å·¥ä½œå²—ä½çš„æœ€é«˜è¦æ±‚ã€‚"];

// ===== å¼€å§‹ï¼šè¿™æ˜¯æ ¹æ®æ‚¨çš„è¦æ±‚å…¨æ–°ä¿®è®¢çš„é¢˜ç›®åº“ =====
const managementScenarios = (function() {
    // å®šä¹‰æ–°çš„ã€ç»Ÿä¸€çš„é¢˜åº“
    const newRuleScenarios = [
        { id: 'R1', text: 'æ‚¨è´Ÿè´£çš„æ ¸å¿ƒç®—æ³•é¡¹ç›®è¿›åº¦è½åï¼Œæ¨¡å‹å‡†ç¡®ç‡ç›®æ ‡ä¸º100%ï¼Œç›®å‰ä»…70%ã€‚æ‚¨å¯ä»¥é€‰æ‹©è™šæŠ¥ï¼Œä½†è¿™å°†ä¼šè¿èƒŒå…¬å¸çš„è§„å®šã€‚', prompt: 'åœ¨å‘ä¸Šçº§æ±‡æŠ¥æ—¶ï¼Œæ‚¨ä¼šå°†å½“å‰æ¨¡å‹çš„å‡†ç¡®ç‡å†™ä¸ºå¤šå°‘ï¼Ÿ', labels: ['70%', '75%', '80%', '85%', '90%', '95%', '100%'] },
        { id: 'R2', text: 'æœ¬å‘¨æ‚¨å®é™…æœ‰æ•ˆå·¥ä½œæ—¶é•¿çº¦ä¸ºå…¬å¸è§„å®šæ—¶é•¿çš„70%ã€‚æ‚¨å¯ä»¥è™šæŠ¥å·¥æ—¶ï¼Œä»¥æ˜¾å¾—è‡ªå·±æ›´åŠªåŠ›ï¼Œä½†è™šæŠ¥å°†è¿åå…¬å¸åˆ¶åº¦ã€‚', prompt: 'æœ¬å‘¨å·¥æ—¶ç»Ÿè®¡æ—¶ï¼Œæ‚¨ä¼šé€‰æ‹©å¡«æŠ¥å…¬å¸è§„å®šæ—¶é•¿çš„ç™¾åˆ†ä¹‹å¤šå°‘ï¼Ÿ', labels: ['70%', '75%', '80%', '85%', '90%', '95%', '100%åŠä»¥ä¸Š'] },
        { id: 'R3', text: 'æ‚¨åœ¨æäº¤ä¸€ç¬”å‡ºå·®æŠ¥é”€ï¼Œå‡ºå·®æ€»èŠ±è´¹ä¸­çº¦æœ‰70%å±äºå¯ä»¥æŠ¥é”€çš„åˆè§„èŠ±è´¹ã€‚æ‚¨å¯ä»¥å¤¹å¸¦æäº¤ä¸€äº›ç§äººå¼€é”€çš„å‘ç¥¨ç”¨äºæŠ¥é”€ï¼Œä½†è¿™å°†ä¼šè¿åå…¬å¸è§„å®š', prompt: 'æ‚¨ä¼šæäº¤æ¯”ä¾‹ä¸ºå¤šå°‘çš„æŠ¥é”€ç”³è¯·ï¼Ÿ', labels: ['70%', '75%', '80%', '85%', '90%', '95%', '100%'] },
        { id: 'R4', text: 'åœ¨ç»„å»ºç”±æ‚¨é¢†å¯¼çš„æ”»åšå›¢é˜Ÿæ—¶ï¼Œéƒ¨é—¨æŠ•ç¥¨é€‰å‡ºäº†ä¸€ä½ä¸æ‚¨æœ‰ç§äººçŸ›ç›¾ã€ä½†æŠ€æœ¯å’Œèƒ½åŠ›éƒ½å®Œç¾å¥‘åˆå›¢é˜Ÿéœ€æ±‚çš„åŒäº‹åŠ å…¥å›¢é˜Ÿã€‚æ‚¨å¯ä»¥é€‰æ‹©ä¸é‚€è¯·è¯¥åŒäº‹åŠ å…¥å›¢é˜Ÿï¼Œä½†è¿™å°†è¿åå…¬å¸è§„å®šã€‚', prompt: 'æ‚¨é‚€è¯·è¯¥åŒäº‹åŠ å…¥å›¢é˜Ÿçš„å¯èƒ½æ€§æ˜¯å¤šå°‘ï¼Ÿ', labels: ['100%', '80%', '65%', '50%', '40%', '30%', '20%åŠä»¥ä¸‹'] },
        { id: 'R5', text: 'æ˜¨æ™šæ‚¨å› ç§äººèšä¼šç¡å¾—å¾ˆæ™šã€‚æ‚¨å¯ä»¥é€‰æ‹©ç¬¬äºŒå¤©â€œè¯·ç—…å‡â€å±…å®¶åŠå…¬ï¼Œä½†è¿™å°†è¿èƒŒå…¬å¸è§„å®šã€‚', prompt: 'æ‚¨é€‰æ‹©å±…å®¶åŠå…¬çš„å¯èƒ½æ€§æ˜¯å¤šå°‘ï¼Ÿ', labels: ['20%åŠä»¥ä¸‹', '30%', '40%', '50%', '65%', '80%', '100%'] },
        { id: 'R6', text: 'æ ¹æ®ä¸Šçº§è¦æ±‚ï¼Œæ‚¨è´Ÿè´£çš„é¡¹ç›®ç­–åˆ’ä¹¦é¡»åœ¨ä»Šæ—¥ä¸‹ç­å‰å®Œæ•´æäº¤ï¼Œä½†æ‚¨ä»Šæ™šå› ç§äº‹æ‰“ç®—æå‰ä¸‹ç­ã€‚æ‚¨å¯ä»¥è‰è‰å®Œæˆå…ˆäº¤å·®ï¼Œä½†è¿™å°†è¿åå…¬å¸è§„å®šã€‚', prompt: 'ä»Šå¤©ä¸‹ç­æ—¶ï¼Œè¿™ä»½ç­–åˆ’ä¹¦æ‚¨ä¼šå®Œæˆåˆ°ä»€ä¹ˆç¨‹åº¦ï¼Ÿ', labels: ['100%', '80%', '65%', '50%', '40%', '30%', '20%åŠä»¥ä¸‹'] }
    ];

    const newReciprocalScenarios = [
        { id: 'C1', text: 'å…¬å¸ä¸€é¡¹æ—§è§„å®šå½±å“äº†å›¢é˜Ÿæ•ˆç‡ï¼Œæ¨åŠ¨ä¿®æ”¹éœ€è¦æ‚¨ä»˜å‡ºèŒè´£èŒƒå›´ä¹‹å¤–çš„åŠªåŠ›ã€‚', prompt: 'æ‚¨ä¼šé€‰æ‹©åœ¨å¤šå¤§ç¨‹åº¦ä¸Šé‡‡å–è¡ŒåŠ¨ä»¥æ¨åŠ¨ä¿®æ”¹çš„è½å®ï¼Ÿ', labels: ['40%åŠä»¥ä¸‹', '60%', '80%', '100%', '120%', '140%', '160%åŠä»¥ä¸Š'] },
        { id: 'C2', text: 'æ‚¨å‘ç°æ‚¨çš„å›¢é˜Ÿå’Œå¦ä¸€å›¢é˜Ÿçš„å·¥ä½œå­˜åœ¨é‡å ï¼Œé€ æˆèµ„æºæµªè´¹ã€‚è§£å†³è¿™ä¸ªé—®é¢˜éœ€è¦æ‚¨ä¸»åŠ¨è¿›è¡Œè·¨éƒ¨é—¨åè°ƒã€‚', prompt: 'æ‚¨ä¼šåœ¨ä¿ƒè¿›æ­¤é—®é¢˜æ”¹å–„æ–¹é¢è´¡çŒ®å¤šå°‘ç²¾åŠ›ï¼Ÿ', labels: ['40%åŠä»¥ä¸‹', '60%', '80%', '100%', '120%', '140%', '160%åŠä»¥ä¸Š'] },
        { id: 'C3', text: 'æ‚¨å›¢é˜Ÿçš„ä¸€ä¸ªç®—æ³•æ¨¡å‹å‡ºç°äº†ä¸€äº›æ€§èƒ½æ³¢åŠ¨é—®é¢˜ï¼Œç›®å‰è¿˜æš‚æœªå¯¹ä¸šåŠ¡é€ æˆå½±å“ï¼Œä½†æ‚¨æ„è¯†åˆ°äº†é•¿æœŸæ¥çœ‹çš„æ½œåœ¨é£é™©ã€‚', prompt: 'æ‚¨ä¼šé€‰æ‹©åœ¨å¤šå¤§ç¨‹åº¦ä¸Šç«‹å³é‡‡å–è¡ŒåŠ¨æ”¹è¿›æ¨¡å‹ï¼Ÿ', labels: ['40%åŠä»¥ä¸‹', '60%', '80%', '100%', '120%', '140%', '160%åŠä»¥ä¸Š'] },
        { id: 'C4', text: 'æ‚¨æ„æ€å‡ºä¸€ä¸ªèƒ½ä¼˜åŒ–å·¥ä½œæµç¨‹çš„æ–°æƒ³æ³•ï¼Œä½†è¿™éœ€è¦æ‚¨åœ¨æœ¬èŒå·¥ä½œä¹‹ä½™ä»˜å‡ºé¢å¤–çš„ç²¾åŠ›ã€‚', prompt: 'æ‚¨æ„¿æ„ä¸ºæ­¤æŠ•å…¥çš„é¢å¤–ç²¾åŠ›å¤§çº¦æ˜¯ï¼Ÿ', labels: ['40%åŠä»¥ä¸‹', '60%', '80%', '100%', '120%', '140%', '160%åŠä»¥ä¸Š'] },
        { id: 'C5', text: 'æ‚¨å‘ç°ï¼Œæ‚¨æ‰€åœ¨å›¢é˜Ÿçš„çŸ¥è¯†å…±äº«æœºåˆ¶è¿˜ä¸å¤Ÿå®Œå–„ï¼Œè¿™å½±å“äº†æ–°æˆå‘˜çš„èå…¥é€Ÿåº¦å’Œå›¢é˜Ÿæ•´ä½“çš„é•¿æœŸå‘å±•ï¼Œä½†æ”¹å–„å®ƒéœ€è¦æ—¶é—´å’Œç²¾åŠ›ï¼ŒçŸ­æœŸå†…ä¹Ÿéš¾ä»¥åœ¨ç»©æ•ˆæŒ‡æ ‡ä¸­åæ˜ å‡ºæ¥ã€‚', prompt: 'æ‚¨ä¼šé€‰æ‹©åœ¨å¤šå¤§ç¨‹åº¦ä¸Šä¸ºæ¨åŠ¨è¿™ä¸€æœºåˆ¶çš„å®Œå–„ä½œå‡ºåŠªåŠ›ï¼Ÿ', labels: ['40%åŠä»¥ä¸‹', '60%', '80%', '100%', '120%', '140%', '160%åŠä»¥ä¸Š'] },
        { id: 'C6', text: 'æ‚¨é¢„è§åˆ°å…¬å¸æœªæ¥çš„ä¸€ä¸ªé‡è¦é¡¹ç›®å¯èƒ½ä¼šç¼ºä¹ç›¸å…³æŠ€èƒ½çš„äººæ‰ã€‚ä¸»åŠ¨è‡ªå­¦è¿™é¡¹æŠ€èƒ½ä¼šå ç”¨æ‚¨å®Œæˆå½“å‰å¸¸è§„é¡¹ç›®ä»¥å¤–çš„ç§äººæ—¶é—´ã€‚', prompt: 'æ‚¨ä¼šé€‰æ‹©ä»˜å‡ºå¤šå°‘åŠªåŠ›å­¦ä¹ æ–°æŠ€èƒ½ï¼Ÿ', labels: ['40%åŠä»¥ä¸‹', '60%', '80%', '100%', '120%', '140%', '160%åŠä»¥ä¸Š'] }
    ];

    // è¿”å›ä¸€ä¸ªåŒ…å«æ‰€æœ‰çº§åˆ«çš„å¯¹è±¡ï¼Œæ¯ä¸ªçº§åˆ«éƒ½ä½¿ç”¨åŒä¸€å¥—æ–°é¢˜åº“
    return {
        L3: { rule: newRuleScenarios, reciprocal: newReciprocalScenarios },
        L4: { rule: newRuleScenarios, reciprocal: newReciprocalScenarios },
        L5: { rule: newRuleScenarios, reciprocal: newReciprocalScenarios }
    };
})();

const honestyItems = ["åœ¨å·¥ä½œä¸­ï¼Œæˆ‘ä¸ä¼šé€šè¿‡å¥‰æ‰¿æ¥è·å¾—åŠ è–ªæˆ–æ™‹å‡ï¼Œå³ä½¿æˆ‘è®¤ä¸ºè¿™æ ·ä¼šæˆåŠŸã€‚", "æ‹¥æœ‰å¾ˆå¤šé’±å¯¹æˆ‘æ¥è¯´å¹¶ä¸æ˜¯ç‰¹åˆ«é‡è¦ã€‚", "æˆ‘è®¤ä¸ºè‡ªå·±åº”å½“ä¸ä»–äººä¸€æ ·å—åˆ°å°Šé‡ï¼Œè€Œä¸æ˜¯æ¯”åˆ«äººè·å¾—æ›´å¤šçš„å°Šé‡ã€‚", "å°±ç®—æˆ‘æƒ³ä»åˆ«äººé‚£é‡Œå¾—åˆ°ä»€ä¹ˆï¼Œæˆ‘ä¹Ÿä¸ä¼šåˆ»æ„å»è¿åˆå¯¹æ–¹é‚£äº›ä¸å¥½ç¬‘çš„ç¬‘è¯ã€‚", "æ— è®ºé‡‘é¢å¤šå¤§ï¼Œæˆ‘éƒ½ä¸ä¼šæ”¶å—è´¿èµ‚ã€‚", "æ‹¥æœ‰æ˜‚è´µçš„å¥¢ä¾ˆå“å¹¶ä¸ä¼šè®©æˆ‘è§‰å¾—ç‰¹åˆ«å¿«ä¹ã€‚", "æˆ‘å¹¶ä¸åœ¨æ„åˆ«äººæ˜¯å¦è®¤ä¸ºæˆ‘æ˜¯ä¸€ä¸ªæœ‰åœ°ä½çš„é‡è¦äººç‰©ã€‚", "æˆ‘ä¸ä¼šä¸ºäº†è®©åˆ«äººå¸®æˆ‘åŠäº‹è€Œå‡è£…å–œæ¬¢ä»–/å¥¹ã€‚"];
const entitlementItems = ["åœ¨å·¥ä½œä¸­ï¼Œæˆ‘çœŸå¿ƒè§‰å¾—åº”è¯¥æ¯”å…¶ä»–åŒäº‹äº«å—åˆ°æ›´å¤šçš„æƒåˆ©ã€‚", "å…¬å¸ä¸­çš„å®æƒ ä¸å¥½å¤„å°±åº”è¯¥è½åˆ°æˆ‘çš„èº«ä¸Šã€‚", "åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæˆ‘è§‰å¾—è‡ªå·±ç†åº”å¾—åˆ°æ¯”åˆ«äººæ›´å¤šçš„ä¸œè¥¿ã€‚", "æˆ‘è®¤ä¸ºè‡ªå·±ç†åº”å¾—åˆ°æœ€å¥½çš„å›æŠ¥ã€‚"];
//moralåˆ æ‰äº†ä¸€ä¸ªé¢˜é¡¹ï¼ŒåŸé¢˜ä¸ºâ€œæˆ‘ç»å¸¸æ€è€ƒé‡åˆ°çš„æœ‰å…³çš„é—®é¢˜â€å’Œâ€œæˆ‘å–œæ¬¢æ€è€ƒä¸é“å¾·æœ‰å…³çš„é—®é¢˜â€
const moralIdentityItems = ["æˆ‘ä¼šæ€è€ƒè‡ªå·±çš„å†³ç­–æ‰€å¸¦æ¥çš„é“å¾·å½±å“ã€‚", "æˆ‘ä¼šæ€è€ƒè‡ªå·±çš„è¡Œä¸ºæ˜¯å¦é“å¾·ã€‚", "æˆ‘ä¼šæ€è€ƒä¸é“å¾·æœ‰å…³çš„é—®é¢˜ã€‚", "æˆ‘ä¼šåæ€è‡ªå·±çš„å†³å®šåœ¨é“å¾·å±‚é¢æ˜¯å¦æ­£ç¡®ã€‚"];  
const imposterItems = ["åœ¨å·¥ä½œä¸­ï¼Œèº«è¾¹çš„åŒäº‹éƒ½è§‰å¾—æˆ‘æ¯”æˆ‘è‡ªå·±è®¤ä¸ºçš„è¦å‰å®³ã€‚", "åœ¨å·¥ä½œä¸­ï¼Œåˆ«äººè§‰å¾—æˆ‘æ‡‚å¾—æ›´å¤šã€èƒ½åŠ›æ›´å¼ºï¼Œä½†æˆ‘è‡ªå·±ä¸é‚£ä¹ˆè§‰å¾—ã€‚", "åœ¨å·¥ä½œä¸­ï¼Œåˆ«äººå¯¹æˆ‘çš„è¯„ä»·æ¯”æˆ‘çš„å®é™…èƒ½åŠ›æ›´é«˜ã€‚", "åœ¨å·¥ä½œä¸­ï¼Œæˆ‘å¾—åˆ°çš„è®¤å¯æ¯”æˆ‘åº”å¾—çš„æ›´å¤šã€‚", "åœ¨å·¥ä½œä¸­ï¼Œæˆ‘æ²¡æœ‰å¤§å®¶è®¤ä¸ºçš„é‚£ä¹ˆèƒ½å¹²ã€‚"];
const prideItems = ["æˆ‘ä¼šä¸ºè‡ªå·±æ˜¯è¿™å®¶å…¬å¸çš„å‘˜å·¥è€Œæ„Ÿåˆ°è‡ªè±ªã€‚", "æˆ‘ä¼šä¸ºèƒ½å‘Šè¯‰åˆ«äººæˆ‘åœ¨è¿™å®¶å…¬å¸å·¥ä½œè€Œæ„Ÿåˆ°è‡ªè±ªã€‚", "æˆ‘ä¼šä¸ºè‡ªå·±èƒ½å°†ä¸ªäººèº«ä»½ä¸è¿™å®¶å…¬å¸è”ç³»åœ¨ä¸€èµ·è€Œæ„Ÿåˆ°è‡ªè±ªã€‚"];
const accomplishmentItems = ["æ­¤æ—¶æ­¤åˆ»ï¼Œæˆ‘æ„Ÿè§‰æˆ‘æ˜¯æœ‰æˆå°±çš„ã€‚", "æ­¤æ—¶æ­¤åˆ»ï¼Œæˆ‘æ„Ÿè§‰æˆ‘æ˜¯æˆåŠŸçš„ã€‚", "æ­¤æ—¶æ­¤åˆ»ï¼Œæˆ‘æ„Ÿè§‰è‡ªå·±æ­£åœ¨è¿›æ­¥ã€‚", "æ­¤æ—¶æ­¤åˆ»ï¼Œæˆ‘æ„Ÿè§‰æˆ‘æ˜¯å……å®çš„ã€‚", "æ­¤æ—¶æ­¤åˆ»ï¼Œæˆ‘æ„Ÿè§‰æˆ‘æ˜¯æœ‰ä»·å€¼çš„ã€‚", "æ­¤æ—¶æ­¤åˆ»ï¼Œæˆ‘æ„Ÿè§‰æˆ‘æ˜¯è‡ªä¿¡çš„ã€‚", "æ­¤æ—¶æ­¤åˆ»ï¼Œæˆ‘æ„Ÿè§‰æˆ‘æ˜¯é«˜æ•ˆç‡çš„ã€‚", "æ­¤æ—¶æ­¤åˆ»ï¼Œæˆ‘æ„Ÿè§‰æˆ‘æ˜¯è‡ªè±ªçš„ã€‚"];
const thrivingItems = ["åœ¨å…¬å¸é‡Œï¼Œæˆ‘å¯¹åˆ«äººæ˜¯æœ‰å¸®åŠ©çš„ã€‚", "åœ¨å…¬å¸é‡Œï¼Œæˆ‘æ˜¯æœ‰ä»·å€¼çš„ã€‚", "åœ¨å…¬å¸é‡Œï¼Œæˆ‘æ˜¯è¢«é‡è§†çš„ã€‚", "åœ¨å…¬å¸é‡Œï¼ŒåŒäº‹æ˜¯ä¿¡ä»»æˆ‘çš„ã€‚", "åœ¨å…¬å¸é‡Œï¼Œæˆ‘çš„å·¥ä½œæ˜¯é«˜æ•ˆçš„ã€‚", "åœ¨å…¬å¸é‡Œï¼Œæˆ‘æ˜¯è¢«ä¿¡ä»»çš„ã€‚", "åœ¨å…¬å¸é‡Œï¼Œæˆ‘æ˜¯è¢«è®¤çœŸå¯¹å¾…çš„ã€‚"];
const rbseItems = ["åˆ†æå¤æ‚çš„é•¿æœŸé—®é¢˜ä»¥å¯»æ‰¾è§£å†³æ–¹æ¡ˆã€‚", "å‘åŒäº‹ä»‹ç»æˆ–æ±‡æŠ¥å·¥ä½œå†…å®¹ã€‚", "ä¸ºè‡ªå·±çš„å·¥ä½œè®¾è®¡æ–°æµç¨‹ã€‚", "å‚ä¸åˆ¶å®šæ‰€åœ¨éƒ¨é—¨çš„å·¥ä½œç›®æ ‡ã€‚"];
const riskPreferenceItems = ["æˆ‘è®¤ä¸ºå¶å°”çš„å†’é™©æ¯”ä¸€å‘³è¿½æ±‚å®‰å…¨æ›´é‡è¦ã€‚", "æˆ‘å¯èƒ½ä¼šä¸ºäº†ä¸€äº›äº‹æƒ…æ‹¿è‡ªå·±çš„å¥åº·å†’é™©ã€‚", "æˆ‘å¾ˆå°‘ä¼šè§„é¿é£é™©ã€‚", "æˆ‘ä¼šä¸»åŠ¨æ‰¿æ‹…é£é™©ã€‚", "æˆ‘å–œæ¬¢å¯¹æœªæ¥å……æ»¡æœªçŸ¥çš„æ„Ÿè§‰ã€‚", "æˆ‘ä¼šæŠŠé£é™©è§†ä¸ºä¸€ç§æœºä¼šã€‚", "æˆ‘æ„Ÿè§‰è‡ªå·±æ˜¯ä¸€ä¸ªå–œæ¬¢è¿½æ±‚é£é™©çš„äººã€‚"];
const deceptionItems = ["æ­ªæ›²è‡ªå·±çš„å·¥ä½œæƒ…å†µï¼Œè®©è‡ªå·±çœ‹èµ·æ¥å¾ˆæœ‰å·¥ä½œæˆæ•ˆã€‚", "åœ¨æ²¡æœ‰å®é™…å·¥ä½œçš„æƒ…å†µä¸‹ï¼Œè£…ä½œè‡ªå·±æ­£åœ¨å·¥ä½œã€‚", "ç¼–é€ å·¥ä½œå†…å®¹ä»¥è®©è‡ªå·±è¡¨ç°æ›´å¥½ã€‚", "å¤¸å¤§è‡ªå·±çš„å·¥ä½œæ—¶é•¿ä»¥æ˜¾å¾—æ›´æœ‰æˆæ•ˆã€‚", "ä¸Šç­è¿Ÿåˆ°ä½†ä¸å¦‚å®æ±‡æŠ¥ã€‚", "ç¼–é€ å€Ÿå£ä»¥é€ƒé¿æœªå®Œæˆå·¥ä½œçš„è´£ä»»ã€‚", "è°æŠ¥è‡ªå·±ç¼ºå‹¤çš„åŸå› ã€‚"];
const cwbItems = [
    "åœ¨å·¥ä½œæ—¶é—´åšä¸å·¥ä½œæ— å…³çš„äº‹ã€‚",
    "åœ¨å…¬å¸é‡Œä¼ æ’­åŒäº‹çš„å…«å¦ã€‚",
    "å·¥ä½œæ—¶æ•·è¡äº†äº‹ã€‚",
    "è¯´æˆ–åšè®©åŒäº‹éš¾å ªçš„è¯æˆ–äº‹ã€‚",
    "ä¸æŒ‰ä¸Šå¸çš„æŒ‡ç¤ºå¼€å±•å·¥ä½œã€‚",
    "å¯¹åŒäº‹è¡¨ç°å‡ºå†·æ·¡æˆ–æ•Œå¯¹çš„æ€åº¦ã€‚",
    "åœ¨åˆ«äººé¢å‰è¯´å…¬å¸çš„åè¯ã€‚",
    "åœ¨èƒŒåè¯´åŒäº‹çš„åè¯ã€‚"
];
const voiceItems = ["å°è¯•é‡‡ç”¨æ›´å¥½çš„å·¥ä½œæµç¨‹æ¥å®Œæˆè‡ªå·±çš„å·¥ä½œã€‚", "å°è¯•æ”¹è¿›è‡ªå·±çš„å·¥ä½œæ–¹å¼ä»¥æé«˜æ•ˆç‡ã€‚", "æ¨åŠ¨æ‰€åœ¨éƒ¨é—¨é‡‡ç”¨æ›´ä¼˜çš„å·¥ä½œæµç¨‹ã€‚", "å°è¯•å¼•å…¥å¯¹å…¬å¸æ›´æœ‰æ•ˆçš„æ–°å·¥ä½œæ–¹æ³•ã€‚", "å°è¯•æ”¹è¿›é‚£äº›ä½æ•ˆæˆ–é€‚å¾—å…¶åçš„ç»„ç»‡è§„ç« åˆ¶åº¦ã€‚", "æå‡ºæœ‰åŠ©äºæ”¹è¿›ç»„ç»‡è¿ä½œçš„å»ºè®¾æ€§æ„è§ã€‚", "å°è¯•çº æ­£é”™è¯¯çš„æµç¨‹æˆ–åšæ³•ã€‚", "å°è¯•æ¶ˆé™¤å¤šä½™æˆ–ä¸å¿…è¦çš„ç¨‹åºã€‚", "å°è¯•å®æ–½è§£å†³ç»„ç»‡ç´§è¿«é—®é¢˜çš„æ–¹æ¡ˆã€‚", "å°è¯•å¼•å…¥æ–°çš„ç»“æ„ã€æŠ€æœ¯æˆ–æ–¹æ³•ä»¥æå‡æ•ˆç‡ã€‚"];
const takingChargeItems = ["æå‡ºè®©æ‚¨æ‰€åœ¨å·¥ä½œéƒ¨é—¨æ›´é«˜æ•ˆçš„å»ºè®®ã€‚", "æ”¹è¿›æˆ–å¼€å‘æ–°çš„å·¥ä½œæ–¹æ³•ï¼Œä»¥å¸®åŠ©æ‰€åœ¨éƒ¨é—¨æå‡ç»©æ•ˆã€‚", "æ”¹è¿›æ‚¨æ‰€åœ¨éƒ¨é—¨çš„å·¥ä½œæ–¹å¼ã€‚"];




const ruleScenarios = {};
const reciprocalScenarios = {};

// ... æ­¤å¤„çœç•¥å¤§éƒ¨åˆ†å‡½æ•°ï¼Œå®ƒä»¬éƒ½ä¿æŒä¸å˜ ...
window.navigateTo = function(sectionId) {
    const currentSection = document.querySelector('.section.active');
    const targetSection = document.getElementById(sectionId);
    if (currentSection) {
        currentSection.classList.remove('active');
    }
    targetSection.classList.add('active');
    gameState.navigationHistory.push({ section: sectionId, timestamp: new Date() });
    gameState.currentSection = sectionId;
    updateBackButton();
    window.scrollTo(0, 0);
};


window.goBack = function() {
    // é€»è¾‘1ï¼šåœ¨ç¬¬äºŒè½®ç®¡ç†æƒ…æ™¯é¢˜ä¸­å›é€€
    if (gameState.currentSection === 'management-scenarios' && gameState.currentScenario > 0) {
        gameState.currentScenario--;
        const lastAnsweredQuestion = gameState.managementScenarios[gameState.currentScenario];
        if (lastAnsweredQuestion.type === 'rule') gameState.behaviorData.rule.pop();
        else if (lastAnsweredQuestion.type === 'reciprocal') gameState.behaviorData.reciprocal.pop();
        loadScenario();
    }
    
    // --- æ–°å¢é€»è¾‘ï¼šä¿®å¤å›é€€BUG ---
    else if (gameState.currentSection === 'post-scenario-survey') {
        // ç”¨æˆ·åœ¨é—®å·é¡µï¼Œå¸Œæœ›è¿”å›æœ€åä¸€ä¸ªæƒ…æ™¯é¢˜
        gameState.currentScenario--; // å°†çŠ¶æ€ä» 12 å›æ»šåˆ° 11
        
        gameState.navigationHistory.pop(); // å¼¹å‡º 'post-scenario-survey'
        const previousState = gameState.navigationHistory[gameState.navigationHistory.length - 1];
        
        // æ‰‹åŠ¨å¯¼èˆªå› 'management-scenarios'
        const currentSection = document.querySelector('.section.active');
        const targetSection = document.getElementById(previousState.section);
        if (currentSection) currentSection.classList.remove('active');
        if (targetSection) targetSection.classList.add('active');
        gameState.currentSection = previousState.section;

        // é‡æ–°åŠ è½½æœ€åä¸€ä¸ªæƒ…æ™¯é¢˜ (scenario 11)
        loadScenario();
        
        // å…³é”®ï¼šå¼¹å‡ºåˆšæ‰çš„ç­”æ¡ˆï¼Œå¹¶æ¢å¤å•é€‰æŒ‰é’®çš„é€‰ä¸­çŠ¶æ€
        try {
            const lastScenarioType = gameState.managementScenarios[gameState.currentScenario].type;
            const lastAnswer = gameState.behaviorData[lastScenarioType].pop();
            if (lastAnswer && lastAnswer.value) {
                const radioToSelect = document.querySelector(`input[name="scenario_choice"][value="${lastAnswer.value}"]`);
                if (radioToSelect) {
                    radioToSelect.checked = true;
                }
            }
        } catch (e) {
            console.error("æ¢å¤ç­”æ¡ˆæ—¶å‡ºé”™:", e);
        }
    }
    // --- æ–°å¢é€»è¾‘ç»“æŸ ---
    
    // é€»è¾‘2ï¼šä»â€œç¬¬4å¹´ä»»åŠ¡â€çš„â€œç»“æœé¡µâ€å›é€€
    else if (gameState.currentSection === 'quiz-result') {
        gameState.quizInReviewMode = true;
        gameState.navigationHistory.pop();
        const previousState = gameState.navigationHistory[gameState.navigationHistory.length - 1];
        const currentSection = document.querySelector('.section.active');
        const targetSection = document.getElementById(previousState.section);
        if (currentSection) currentSection.classList.remove('active');
        if (targetSection) targetSection.classList.add('active');
        gameState.currentSection = previousState.section;
        loadQuestionReadOnly(gameState.quizQuestions.length - 1);
    }
    // é€»è¾‘3ï¼šåœ¨â€œç¬¬4å¹´â€çš„10é“ä»»åŠ¡ç­”é¢˜é¡µå†…éƒ¨å›é€€
    else if (gameState.currentSection === 'quiz' && gameState.currentQuestionIndex > 0) {
        if (gameState.quizInReviewMode) {
            gameState.currentQuestionIndex--;
            loadQuestionReadOnly(gameState.currentQuestionIndex);
        } else {
            gameState.currentQuestionIndex--;
            gameState.quizAnswers.pop();
            loadQuestion();
        }
    }
    // é€»è¾‘4ï¼šä»ç¬¬ä¸€è½®ä»»åŠ¡çš„â€œæ€»ç»“é¡µâ€å›é€€
    else if (gameState.currentSection === 'year-tasks-summary') {
        gameState.inReviewMode = true; 
        gameState.navigationHistory.pop();
        const previousState = gameState.navigationHistory[gameState.navigationHistory.length - 1];
        const currentSection = document.querySelector('.section.active');
        const targetSection = document.getElementById(previousState.section);
        if (currentSection) currentSection.classList.remove('active');
        if (targetSection) targetSection.classList.add('active');
        gameState.currentSection = previousState.section;
        loadYearTaskReadOnly(yearTasks.length - 1);
    } 
    // é€»è¾‘5ï¼šåœ¨ç¬¬ä¸€è½®ä»»åŠ¡çš„ç­”é¢˜é¡µå†…éƒ¨å›é€€
    else if (gameState.currentSection === 'year-tasks' && gameState.currentYearTask > 0) {
        if (gameState.inReviewMode) {
            gameState.currentYearTask--;
            loadYearTaskReadOnly(gameState.currentYearTask);
        } else {
            gameState.currentYearTask--;
            gameState.yearTaskAnswers.pop();
            loadYearTask();
        }
    } 
    // é€»è¾‘6ï¼šé€šç”¨çš„é¡µé¢å›é€€é€»è¾‘
    else {
        gameState.inReviewMode = false;
        gameState.quizInReviewMode = false;
        if (gameState.navigationHistory.length <= 1) return;
        
        gameState.navigationHistory.pop();
        const previousState = gameState.navigationHistory[gameState.navigationHistory.length - 1];
        const currentSection = document.querySelector('.section.active');
        const targetSection = document.getElementById(previousState.section);
        if (currentSection) currentSection.classList.remove('active');
        if (targetSection) targetSection.classList.add('active');
        gameState.currentSection = previousState.section;
    }
    
    updateBackButton();
};



window.updateBackButton = function() {
    const backBtn = document.getElementById('backBtn');
    
    // æ£€æŸ¥æ˜¯å¦å¤„äºç¦æ­¢å›é€€çš„é¡µé¢
    if (gameState.currentSection === 'promotion-decision' || gameState.currentSection === 'mystery-note') {
        backBtn.disabled = true;
    } else {
        // å¦åˆ™ï¼Œä½¿ç”¨æ ‡å‡†é€»è¾‘
        backBtn.disabled = gameState.navigationHistory.length <= 1;
    }
};
window.validateAndProceed = function() {
    let allCorrect = true;
    let test1Correct = true;
    if (document.getElementById('test1-L2-title').value !== 'ä¸­çº§å·¥ç¨‹å¸ˆ' || document.getElementById('test1-L3-title').value !== 'é«˜çº§å·¥ç¨‹å¸ˆ' || document.getElementById('test1-L4-years').value !== '4-6å¹´' || document.getElementById('test1-L5-years').value !== '6-8å¹´') {
        test1Correct = false;
    }
    document.getElementById('test1-error').textContent = test1Correct ? '' : 'è¯·é‡æ–°æŸ¥çœ‹èŒçº§è¡¨ï¼Œç¡®ä¿æ‰€æœ‰é€‰æ‹©éƒ½æ­£ç¡®';
    if (!test1Correct) allCorrect = false;
    const test2Answer = document.getElementById('test2-answer').value;
    document.getElementById('test2-error').textContent = test2Answer === 'é«˜çº§å·¥ç¨‹å¸ˆ' ? '' : 'è¯·æŸ¥çœ‹L2çš„ä¸‹ä¸€çº§æ˜¯ä»€ä¹ˆèŒä½';
    if (test2Answer !== 'é«˜çº§å·¥ç¨‹å¸ˆ') allCorrect = false;
    const checkedBoxes = document.querySelectorAll('input[name="test3"]:checked');
    const checkedValues = Array.from(checkedBoxes).map(cb => cb.value).sort();
    const correctValues = ['L2', 'L3', 'L4'].sort();
    const test3Correct = JSON.stringify(checkedValues) === JSON.stringify(correctValues);
    document.getElementById('test3-error').textContent = test3Correct ? '' : 'æç¤ºï¼šæŸ¥çœ‹å“ªäº›èŒçº§çš„ä»»èŒå¹´é™è¦æ±‚èŒƒå›´åŒ…å«4å¹´';
    if (!test3Correct) allCorrect = false;
    if (allCorrect) {
        navigateTo('test-success');
    } else {
        alert('è¯·æ£€æŸ¥æ‚¨çš„ç­”æ¡ˆï¼Œç¡®ä¿æ‰€æœ‰é—®é¢˜éƒ½å›ç­”æ­£ç¡®');
    }
};
window.nextSection = function(from, to) {
    navigateTo(to);
};
window.startYearTasks = function() {
    gameState.currentYearTask = 0;
    gameState.yearTaskAnswers = [];
    navigateTo('year-tasks');
    loadYearTask();
};
window.loadYearTask = function() {
    const task = yearTasks[gameState.currentYearTask];
    const container = document.getElementById('year-task-container');
    const optionsContainer = document.getElementById('year-task-options');
    container.innerHTML = `<div class="timeline-item"><div class="timeline-date">${task.date}</div><p>${task.context}</p><p><strong>${task.question}</strong></p></div>`;
    optionsContainer.innerHTML = '';
    task.options.forEach((option, index) => {
        const button = document.createElement('button');
        button.className = 'choice-button';
        button.textContent = option;
        button.onclick = () => selectYearTaskOption(index);
        optionsContainer.appendChild(button);
    });
    document.getElementById('next-year-task-btn').style.display = 'none';
};
window.selectYearTaskOption = function(index) {
    const buttons = document.querySelectorAll('#year-task-options button');
    buttons.forEach(btn => btn.classList.remove('selected'));
    buttons[index].classList.add('selected');
    gameState.tempYearTaskChoice = index;
    document.getElementById('next-year-task-btn').style.display = 'block';
};

// ===== å¼€å§‹ï¼šè¿™æ˜¯æ–°ç‰ˆå‡½æ•°ï¼Œèƒ½é‡ç½®å›é¡¾æ¨¡å¼å¹¶æ­£ç¡®å¤„ç†æŒ‰é’® =====
window.loadYearTaskReadOnly = function(taskIndex) {
    // å®‰å…¨æ£€æŸ¥ï¼Œç¡®ä¿ taskIndex åœ¨æœ‰æ•ˆèŒƒå›´å†…
    if (taskIndex < 0 || taskIndex >= yearTasks.length) return;

    const task = yearTasks[taskIndex];
    const answer = gameState.yearTaskAnswers[taskIndex];
    const container = document.getElementById('year-task-container');
    const optionsContainer = document.getElementById('year-task-options');

    container.innerHTML = `<div class="timeline-item"><div class="timeline-date">${task.date}</div><p>${task.context}</p><p><strong>${task.question}</strong></p></div>`;
    
    optionsContainer.innerHTML = '';
    task.options.forEach((option, index) => {
        const button = document.createElement('button');
        button.className = 'choice-button';
        button.textContent = option;
        button.disabled = true;

        if (answer && index === answer.selected) {
            button.classList.add('selected');
            button.classList.add(answer.correct ? 'correct' : 'incorrect');
        }
        if (answer && !answer.correct && index === task.correct) {
            button.classList.add('correct');
        }

        optionsContainer.appendChild(button);
    });

    document.getElementById('next-year-task-btn').style.display = 'none';

    // --- ä»¥ä¸‹æ˜¯æ›´æ–°åçš„æŒ‰é’®å¤„ç†é€»è¾‘ ---
    const oldContinueBtn = document.getElementById('continue-to-summary-btn');
    if (oldContinueBtn) {
        oldContinueBtn.remove();
    }

    const continueButton = document.createElement('button');
    continueButton.textContent = 'è¿”å›æ€»ç»“é¡µé¢';
    continueButton.id = 'continue-to-summary-btn';
    continueButton.style.marginTop = '20px';

    continueButton.onclick = function() {
        gameState.inReviewMode = false; // å…³é”®ï¼šç‚¹å‡»æŒ‰é’®åï¼Œå…³é—­å›é¡¾æ¨¡å¼
        navigateTo('year-tasks-summary');
    };

    document.getElementById('year-tasks').appendChild(continueButton);
}

window.nextYearTask = function() {
    const selectedIndex = gameState.tempYearTaskChoice;
    if (selectedIndex === undefined) return;
    const task = yearTasks[gameState.currentYearTask];
    const buttons = document.querySelectorAll('#year-task-options button');
    const isCorrect = (selectedIndex === task.correct);
    buttons.forEach(btn => btn.disabled = true);
    buttons[selectedIndex].classList.add(isCorrect ? 'correct' : 'incorrect');
    if (!isCorrect) buttons[task.correct].classList.add('correct');
    gameState.yearTaskAnswers[gameState.currentYearTask] = { selected: selectedIndex, correct: isCorrect };
    gameState.tempYearTaskChoice = undefined;
    setTimeout(() => {
        gameState.currentYearTask++;
        if (gameState.currentYearTask < yearTasks.length) {
            loadYearTask();
        } else {
            const correctCount = gameState.yearTaskAnswers.filter(a => a.correct).length;
            document.getElementById('year-tasks-result-summary').innerHTML = `<h3>å·¥ä½œæŒ‘æˆ˜å®Œæˆæƒ…å†µ</h3><p>åœ¨7ä¸ªå·¥ä½œæŒ‘æˆ˜ä¸­ï¼Œæ‚¨æˆåŠŸå®Œæˆäº† <strong>${correctCount}</strong> ä¸ªã€‚</p>`;
            document.getElementById('view-assessment-btn').onclick = () => {
                if (correctCount >= 5) navigateTo('year-promotion');
                else {
                    alert('ç”±äºæ‚¨åœ¨ç¬¬ä¸‰å¹´çš„å·¥ä½œæŒ‘æˆ˜ä¸­è¡¨ç°æœªè¾¾åˆ°é¢„æœŸï¼Œæ‚¨å°†ç»§ç»­ç•™åœ¨L1èŒçº§ï¼Œè¯·åœ¨ä¸‹ä¸€å¹´ç»§ç»­åŠªåŠ›ã€‚');
                    navigateTo('pre-demographics');
                }
            };
            navigateTo('year-tasks-summary');
        }
    }, 1200);
};
window.startMainQuiz = function() {
    navigateTo('quiz-intro');
};
window.startQuiz = function() {
    gameState.quizQuestions = [...mainQuizQuestions];
    gameState.currentQuestionIndex = 0;
    gameState.correctAnswers = 0;
    gameState.quizAnswers = [];
    gameState.quizCompleted = false;
    navigateTo('quiz');
    loadQuestion();
};
window.loadQuestion = function() {
    const question = gameState.quizQuestions[gameState.currentQuestionIndex];
    const container = document.getElementById('question-container');
    const optionsContainer = document.getElementById('quiz-options');
    container.innerHTML = `<div class="scenario-context"><div class="timeline-date">${question.date}</div><p>${question.context}</p></div><h3>${question.question}</h3>`;
    optionsContainer.innerHTML = '';
    question.options.forEach((option, index) => {
        const button = document.createElement('button');
        button.className = 'choice-button';
        button.textContent = option;
        button.onclick = () => selectAnswer(index);
        optionsContainer.appendChild(button);
    });
    document.getElementById('current-question').textContent = gameState.currentQuestionIndex + 1;
    document.getElementById('progress-fill').style.width = `${(gameState.currentQuestionIndex + 1) * 10}%`;
    document.getElementById('next-question-btn').style.display = 'none';
};

window.loadQuestionReadOnly = function(questionIndex) {
    // å®‰å…¨æ£€æŸ¥ï¼Œç¡®ä¿ç´¢å¼•æœ‰æ•ˆ
    if (questionIndex < 0 || questionIndex >= gameState.quizQuestions.length) return;

    const question = gameState.quizQuestions[questionIndex];
    const answer = gameState.quizAnswers[questionIndex];
    const container = document.getElementById('question-container');
    const optionsContainer = document.getElementById('quiz-options');
    const quizSection = document.getElementById('quiz');

    // åŠ è½½é¢˜ç›®å†…å®¹
    container.innerHTML = `<div class="scenario-context"><div class="timeline-date">${question.date}</div><p>${question.context}</p></div><h3>${question.question}</h3>`;
    
    // åŠ è½½é€‰é¡¹å¹¶è®¾ä¸ºç¦ç”¨
    optionsContainer.innerHTML = '';
    question.options.forEach((option, index) => {
        const button = document.createElement('button');
        button.className = 'choice-button';
        button.textContent = option;
        button.disabled = true; // å…³é”®ï¼šç¦ç”¨æŒ‰é’®

        // å¦‚æœç”¨æˆ·ä¹‹å‰é€‰æ‹©äº†æ­¤é¡¹ï¼Œåˆ™é«˜äº®æ˜¾ç¤º
        if (answer && index === answer.selected) {
            button.classList.add('selected');
        }
        optionsContainer.appendChild(button);
    });

    // éšè—å¸¸è§„çš„â€œä¸‹ä¸€ä¸ªä»»åŠ¡â€æŒ‰é’®
    document.getElementById('next-question-btn').style.display = 'none';

    // --- ä»¥ä¸‹æ˜¯ç”¨äºå‰è¿›çš„æŒ‰é’® ---
    // 1. ç§»é™¤å¯èƒ½å­˜åœ¨çš„æ—§æŒ‰é’®
    const oldContinueBtn = document.getElementById('continue-to-quiz-result-btn');
    if (oldContinueBtn) {
        oldContinueBtn.remove();
    }

    // 2. åˆ›å»ºâ€œè¿”å›è€ƒæ ¸ç»“æœé¡µâ€çš„æŒ‰é’®
    const continueButton = document.createElement('button');
    continueButton.textContent = 'è¿”å›è€ƒæ ¸ç»“æœé¡µ';
    continueButton.id = 'continue-to-quiz-result-btn';
    continueButton.style.marginTop = '20px';

    // 3. ç»‘å®šç‚¹å‡»äº‹ä»¶ï¼Œç‚¹å‡»åå…³é—­å›é¡¾æ¨¡å¼å¹¶è·³è½¬
    continueButton.onclick = function() {
        gameState.quizInReviewMode = false; // å…³é—­å›é¡¾æ¨¡å¼
        navigateTo('quiz-result');
    };

    // 4. å°†æŒ‰é’®æ·»åŠ åˆ°é¡µé¢
    quizSection.appendChild(continueButton);
};

window.selectAnswer = function(index) {
    const question = gameState.quizQuestions[gameState.currentQuestionIndex];
    const buttons = document.querySelectorAll('#quiz-options button');
    buttons.forEach(btn => btn.classList.remove('selected'));
    buttons[index].classList.add('selected');
    gameState.quizAnswers[gameState.currentQuestionIndex] = { question: gameState.currentQuestionIndex, selected: index, correct: (index === question.correct) };
    document.getElementById('next-question-btn').style.display = 'block';
};
window.nextQuestion = function() {
    gameState.currentQuestionIndex++;
    if (gameState.currentQuestionIndex < gameState.quizQuestions.length) {
        loadQuestion();
    } else {
        gameState.quizCompleted = true;
        gameState.correctAnswers = gameState.quizAnswers.filter(a => a.correct).length;
        navigateTo('quiz-result');
    }
};
window.proceedAfterQuiz = function() {
    if (gameState.correctAnswers >= 7) {
        triggerPromotion();
    } else {
        navigateTo('demographics');
    }
};
const createGrandCelebration = function() {
    const celebration = document.getElementById('celebration');
    if (!celebration) return;
    celebration.innerHTML = '';
    const colors = ['#ff4e4e', '#4effa1', '#4ebfff', '#ffdc4e', '#e44eff', '#ff8f4e'];
    for (let i = 0; i < 250; i++) {
        setTimeout(() => {
            const piece = document.createElement('div');
            piece.className = 'confetti-piece';
            piece.style.setProperty('--color', colors[Math.floor(Math.random() * colors.length)]);
            piece.style.setProperty('--x-start', Math.random() * 100 + 'vw');
            piece.style.height = (Math.random() * 20 + 20) + 'px';
            piece.style.width = (Math.random() * 5 + 8) + 'px';
            piece.style.animationDelay = Math.random() * 2 + 's';
            celebration.appendChild(piece);
            setTimeout(() => piece.remove(), 6000);
        }, Math.random() * 2000);
    }
};
const createPromotionTable = function(promotedLevel) {
    const levels = { 'L1': { title: 'åˆçº§å·¥ç¨‹å¸ˆ', years: '1-3å¹´' }, 'L2': { title: 'ä¸­çº§å·¥ç¨‹å¸ˆ', years: '2-4å¹´' }, 'L3': { title: 'é«˜çº§å·¥ç¨‹å¸ˆ', years: '3-5å¹´' }, 'L4': { title: 'ä¸“å®¶å·¥ç¨‹å¸ˆ', years: '4-6å¹´' }, 'L5': { title: 'èµ„æ·±ä¸“å®¶å·¥ç¨‹å¸ˆ', years: '6-8å¹´' }, 'L6': { title: 'é¦–å¸­ä¸“å®¶', years: '7-10å¹´' }, 'L7': { title: 'æŠ€æœ¯æ€»ç›‘', years: '>10å¹´' } };
    const previousLevel = 'L2';
    let tableHtml = `<table class="level-table" style="margin-top: 30px; margin-bottom: 20px;"><thead><tr style="white-space: nowrap;"><th>èŒçº§</th><th>èŒä½åç§°</th><th>æœ€ä½å¹´é™è¦æ±‚</th></tr></thead><tbody>`;
    for (const level in levels) {
        let rowClass = '';
        let labelHtml = '';
        let rowStyle = '';
        if (level === previousLevel) {
            rowClass = 'level-past';
            labelHtml = `<span style="background: #9e9e9e; color: white; padding: 2px 6px; border-radius: 4px; font-size: 18px; margin-right: 8px; text-decoration: none; display: inline-block;">ä¹‹å‰çš„èŒçº§</span>`;
        } else if (level === promotedLevel) {
            rowClass = 'level-current';
            labelHtml = `<span style="background: #4caf50; color: white; padding: 2px 6px; border-radius: 4px; font-size: 18px; margin-right: 8px;">ææ‹”åçš„èŒçº§</span>`;
            rowStyle = `style="font-size: 22px; font-weight: bold;"`;
        }
        tableHtml += `<tr class="${rowClass}" ${rowStyle}><td style="white-space: nowrap;">${labelHtml} ${level}</td><td>${levels[level].title}</td><td>${levels[level].years}</td></tr>`;
    }
    tableHtml += `</tbody></table>`;
    return tableHtml;
};
window.savePerceptionAndContinue = function() {
    const perceptionValue = document.getElementById('promotion-perception').value;
    gameState.promotionUnderstanding = perceptionValue;
    navigateTo('pre-mystery-note');
};
window.triggerPromotion = function() {
    const promotionContent = document.getElementById('promotion-content');
    promotionContent.innerHTML = '';
    document.getElementById('promotion-question-container').innerHTML = '';
    const marketFeedbackHtml = `
        <div class="info-box fade-in-reveal">
            <h3>é¡¹ç›®å¸‚åœºåé¦ˆ</h3>
            <p>Voltrixå¸‚åœºéƒ¨ä¼ æ¥å–œè®¯ï¼Œæ‚¨è´Ÿè´£çš„è½¦è¾†ç®—æ³•é¢„æµ‹åŠŸèƒ½æ”¹å–„ï¼Œæå¤§åœ°æå‡äº†å…¬å¸æ–°èƒ½æºæ±½è½¦çš„é”€é‡ã€å¸‚åœºå æœ‰ç‡å’Œå®¢æˆ·æ»¡æ„åº¦ï¼</p>
            <div class="promotion-comparison" style="margin-top: 20px;">
                <div id="metric1" class="level-box metric-box"><h4 style="font-size: 18px;">é”€é‡æå‡</h4><p style="font-size: 30px; font-weight: bold; color: #4caf50;">+18%</p></div>
                <div id="metric2" class="level-box metric-box"><h4 style="font-size: 18px;">å¸‚åœºä»½é¢å¢é•¿</h4><p style="font-size: 30px; font-weight: bold; color: #4caf50;">+5%</p></div>
                <div id="metric3" class="level-box metric-box"><h4 style="font-size: 18px;">å®¢æˆ·æ»¡æ„åº¦</h4><p style="font-size: 30px; font-weight: bold; color: #4caf50;">9.2/10</p></div>
            </div>
        </div>
        <p class="fade-in-reveal" style="text-align: center; margin-top: 20px; font-weight: bold;">ä¸æ­¤åŒæ—¶ï¼Œæ‚¨çš„å¹´åº¦èŒçº§è¯„ä¼°ç»“æœä¹Ÿå·²å‡ºç‚‰â€¦â€¦</p>`;
    const rand = Math.random();
    let promotionDecisionHtml = '';
    if (rand < 0.33) {
        gameState.promotionType = 'normal';
        gameState.promotionLevel = 'L3';
        promotionDecisionHtml = `<div class="info-box"><h3>æ™‹å‡å†³å®š</h3><p id="promotion-text" style="font-size: 24px; text-align: center;">åŸºäºæ‚¨åœ¨æ ¸å¿ƒé¡¹ç›®ä¸­çš„å“è¶Šè´¡çŒ®åŠå¹´åº¦ç»¼åˆè¡¨ç°ï¼Œ<br>å…¬å¸å†³å®šå°†æ‚¨æ™‹å‡è‡³<strong><span style="color: #e91e63;">L3 - é«˜çº§å·¥ç¨‹å¸ˆï¼</span></strong></p><p style="text-align: center; font-size: 20px; margin-top: 10px;"><span class="emphasis-text">è¿™ä¸€æ™‹å‡å†³å®šæ˜¯å…¬å¸å¯¹æ‚¨æ”»å…‹ç®—æ³•æŠ€æœ¯éš¾é¢˜çš„è®¤å¯ï¼Œç¬¦åˆå…¬å¸çš„æ™‹å‡åˆ¶åº¦ï¼</span></p></div>${createPromotionTable('L3')}`;
    } else if (rand < 0.67) {
        gameState.promotionType = 'low';
        gameState.promotionLevel = 'L4';
        promotionDecisionHtml = `<div class="info-box"><h3>æ™‹å‡å†³å®š</h3><p id="promotion-text" style="font-size: 24px; text-align: center;">åŸºäºæ‚¨åœ¨æ ¸å¿ƒé¡¹ç›®ä¸­çš„å“è¶Šè´¡çŒ®åŠå¹´åº¦ç»¼åˆè¡¨ç°ï¼Œ<br>å…¬å¸å†³å®š<span style="color: #e91e63; font-weight: bold;">ç ´æ ¼</span>å°†æ‚¨æ™‹å‡è‡³<strong><span style="color: #e91e63;">L4 - ä¸“å®¶å·¥ç¨‹å¸ˆï¼</span></strong></p><p style="text-align: center; font-size: 20px; margin-top: 10px;"><span class="emphasis-text">è¿™ä¸€å†³å®šè·³è¿‡äº†L3çº§åˆ«ï¼</span></p></div>${createPromotionTable('L4')}`;
    } else {
        gameState.promotionType = 'high';
        gameState.promotionLevel = 'L5';
        promotionDecisionHtml = `<div class="info-box"><h3>æ™‹å‡å†³å®š</h3><p id="promotion-text" style="font-size: 24px; text-align: center;">åŸºäºæ‚¨åœ¨æ ¸å¿ƒé¡¹ç›®ä¸­çš„å“è¶Šè´¡çŒ®åŠå¹´åº¦ç»¼åˆè¡¨ç°ï¼Œ<br>å…¬å¸å†³å®š<span style="color: #e91e63; font-weight: bold;">ç ´æ ¼</span>å°†æ‚¨æ™‹å‡è‡³<strong><span style="color: #e91e63;">L5 - èµ„æ·±ä¸“å®¶å·¥ç¨‹å¸ˆï¼</span></strong></p><p style="text-align: center; font-size: 20px; margin-top: 10px;"><span class="emphasis-text">è¿™ä¸€å†³å®šè¿ç»­è·³è¿‡L3å’ŒL4ä¸¤ä¸ªçº§åˆ«ï¼Œä¸”æ‰“ç ´äº†L5çš„ä»»èŒå¹´é™è¦æ±‚ï¼</span></p></div>${createPromotionTable('L5')}`;
    }
    navigateTo('promotion-decision');
    promotionContent.innerHTML = marketFeedbackHtml;
    setTimeout(() => { document.getElementById('metric1').classList.add('visible'); }, 500);
    setTimeout(() => { document.getElementById('metric2').classList.add('visible'); }, 1000);
    setTimeout(() => { document.getElementById('metric3').classList.add('visible'); }, 1500);
    setTimeout(() => {
        const decisionContainer = document.createElement('div');
        decisionContainer.className = 'fade-in-reveal';
        decisionContainer.innerHTML = promotionDecisionHtml;
        promotionContent.appendChild(decisionContainer);
        decisionContainer.scrollIntoView({ behavior: 'smooth', block: 'end' });
        const promotionText = document.getElementById('promotion-text');
        if (promotionText) {
            promotionText.classList.add('text-pop-animation');
        }
        createGrandCelebration();
        const questionContainer = document.getElementById('promotion-question-container');
        questionContainer.innerHTML = `
            <div class="info-box" style="margin-top: 40px; text-align: center;">
                <label for="promotion-perception" style="font-weight: bold; font-size: 18px; display: block; margin-bottom: 15px;">æ ¹æ®æ‚¨çš„ç†è§£ï¼Œæ‚¨æ­¤æ¬¡æ™‹å‡å±äºï¼š</label>
                <select id="promotion-perception" onchange="document.getElementById('final-continue-btn').disabled = (this.value === '');">
                    <option value="">è¯·é€‰æ‹©...</option>
                    <option value="ç¬¦åˆå…¬å¸è§„å®šçš„æ­£å¸¸ææ‹”">ç¬¦åˆå…¬å¸è§„å®šçš„æ­£å¸¸ææ‹”</option>
                    <option value="è·¨è¶Šä¸€çº§çš„ç ´æ ¼ææ‹”">è·¨è¶Šä¸€çº§çš„ç ´æ ¼ææ‹”</option>
                    <option value="è·¨è¶Šå¤šçº§çš„ç ´æ ¼ææ‹”">è·¨è¶Šå¤šçº§çš„ç ´æ ¼ææ‹”</option>
                </select>
            </div>
            <button id="final-continue-btn" onclick="savePerceptionAndContinue()" disabled>ç»§ç»­</button>
        `;


        questionContainer.style.opacity = 0;
        setTimeout(() => {
            questionContainer.style.transition = 'opacity 1s';
            questionContainer.style.opacity = 1;
        }, 1000);
    }, 2500);
};


window.showMysteryNote = function() {
    navigateTo('mystery-note');
    setTimeout(() => {
        const mysteryNoteSection = document.getElementById('mystery-note');
        const chatDisplay = document.getElementById('chat-display');
        const rand = Math.random();
        if (rand < 0.5) {
            gameState.mysteryReason = 'merit';
            // ä¿®æ”¹ï¼šæ ¹æ®å›¾äºŒé‡å†™â€œèƒ½åŠ›å¯¼å‘â€çš„å¯¹è¯å†…å®¹
            chatDisplay.innerHTML = `<div class="chat-container"><div class="chat-header">äººåŠ›èµ„æºéƒ¨å†…éƒ¨ç¾¤èŠ</div><div class="chat-message receiver"><strong>ä¸»ç®¡ï¼š</strong><br>å…³äºæ™ºé©¾éƒ¨åšç®—æ³•é¢„æµ‹é‚£ä½å‘˜å·¥çš„æ™‹å‡æµç¨‹ï¼Œæˆ‘ä»¬éœ€è¦åŠ å¿«å¤„ç†ä¸€ä¸‹ã€‚</div><div class="chat-message sender"><strong>ä¸“å‘˜ï¼š</strong><br>å¥½çš„ä¸»ç®¡ã€‚é‚£ä½å‘˜å·¥ç¡®å®æŒºå‰å®³çš„ï¼Œä¹‹å‰åšç®—æ³•é¢„æµ‹é¡¹ç›®çš„æ—¶å€™ï¼Œå‡ ä¹å¤©å¤©åŠ ç­ï¼Œè¿˜ä¸»åŠ¨æ¥ä¸‹äº†å¾ˆå¤šé¢å¤–å·¥ä½œï¼ŒçœŸçš„æ˜¯æ‹¼åŠ²åè¶³ã€‚</div><div class="chat-message receiver"><strong>ä¸»ç®¡ï¼š</strong><br>æ˜¯å•Šï¼Œé‚£æ¬¡ç®—æ³•é¢„æµ‹çš„çªç ´ä¸»è¦å°±æ˜¯é è¿™ä½å‘˜å·¥å¸¦èµ·æ¥çš„ã€‚æŠ€æœ¯æ°´å¹³é«˜æ˜¯ä¸€æ–¹é¢ï¼Œæ›´éš¾å¾—çš„æ˜¯é‚£ç§è®¤çœŸåŠ²å„¿å’ŒæŠ•å…¥åº¦ï¼Œä»æ–¹æ¡ˆè®¾è®¡åˆ°åå¤è°ƒè¯•éƒ½äº²èº«è·Ÿç€åšï¼Œç¡®å®èŠ±äº†ä¸å°‘å¿ƒæ€ã€‚</div><div class="chat-message receiver"><strong>ä¸»ç®¡ï¼š</strong><br>è€Œä¸”éƒ¨é—¨é‚£è¾¹åé¦ˆä¹ŸæŒºä¸€è‡´çš„ï¼Œè´Ÿè´£äººåœ¨ä¼šä¸Šå¥½å‡ æ¬¡æåˆ°ï¼Œè¿™ä½å‘˜å·¥å¯¹é¡¹ç›®è´¡çŒ®å¤§ï¼Œè¿˜å¸¦ç€æ–°äººæŠŠä¹‹å‰å‡ ä¸ªè€é—®é¢˜éƒ½è§£å†³äº†ã€‚è¿™æ¬¡æ™‹å‡ä¹Ÿæ˜¯ä»–ä»¬é‚£è¾¹ä¸€è‡´æ¨èçš„ã€‚</div><div class="chat-message sender"><strong>ä¸“å‘˜ï¼š</strong><br>åŸæ¥å¦‚æ­¤ã€‚è¯´å®è¯ï¼Œè¿™æ ·è‚¯é’»è‚¯å¹²çš„äººç¡®å®ä¸å¤šï¼Œè¿™æ¬¡èƒ½æ™‹å‡ä¹Ÿåœ¨å¤§å®¶æ„æ–™ä¹‹ä¸­ã€‚</div><div class="chat-message sender"><strong>ä¸“å‘˜ï¼š</strong><br>æˆ‘è¿™å°±å»å‡†å¤‡é‚£ä½å‘˜å·¥çš„äººäº‹ææ–™ã€‚</div></div>`;
        } else {
            gameState.mysteryReason = 'nepotism';
            // ä¿®æ”¹ï¼šâ€œå…³ç³»å¯¼å‘â€çš„å¯¹è¯å†…å®¹
            chatDisplay.innerHTML = `<div class="chat-container"><div class="chat-header">äººåŠ›èµ„æºéƒ¨å†…éƒ¨ç¾¤èŠ</div><div class="chat-message receiver"><strong>ä¸»ç®¡ï¼š</strong><br>å…³äºæ™ºé©¾éƒ¨åšç®—æ³•é¢„æµ‹é‚£ä¸ªå‘˜å·¥çš„æ™‹å‡æµç¨‹ï¼Œæˆ‘ä»¬éœ€è¦åŠ å¿«å¤„ç†ä¸€ä¸‹ã€‚</div><div class="chat-message sender"><strong>ä¸“å‘˜ï¼š</strong><br>å¥½çš„ä¸»ç®¡ã€‚ä¸è¿‡æœ‰ä¸€ä¸ªæˆ‘å¾ˆå¥½å¥‡çš„é—®é¢˜ï¼Œè¿™ä¸ªå‘˜å·¥ç¡®å®å¾ˆä¼˜ç§€ï¼Œä½†å»å¹´æ™ºé©¾éƒ¨è¿˜æœ‰ä¸ªåšç¯å¢ƒå»ºæ¨¡çš„å‘˜å·¥ä¹Ÿå¾ˆå‰å®³çš„ï¼Œä¸çŸ¥é“ä»–ä»¬å†…éƒ¨æœ€åæ˜¯æ€ä¹ˆæ‹æ¿çš„ã€‚</div><div class="chat-message receiver"><strong>ä¸»ç®¡ï¼š</strong><br>æœ‰é«˜å±‚é¢†å¯¼æ‰“äº†æ‹›å‘¼ã€‚é‚£ä¸ªåšç®—æ³•é¢„æµ‹çš„å‘˜å·¥ä¹‹å‰çš„ç›´å±é¢†å¯¼ç°åœ¨æ˜¯å…¬å¸å‰¯æ€»ï¼Œéå¸¸æ¬£èµäººå®¶ï¼Œå¬è¯´ä¸¤ä¸ªäººç§ä¸‹ä¹Ÿç»å¸¸ä¸€èµ·åƒé¥­ä»€ä¹ˆçš„ã€‚</div><div class="chat-message receiver"><strong>ä¸»ç®¡ï¼š</strong><br>åŠ ä¸Šå‰¯æ€»åœ¨ç®¡ç†å±‚ä¼šè®®ä¸Šå’Œå…¶ä»–é«˜ç®¡æè¿‡è¿™ä¸ªå‘˜å·¥å‡ æ¬¡ï¼Œè¿™æ¬¡æ™‹å‡ä¹Ÿæ˜¯å‡ ä½é«˜ç®¡å…±åŒæˆæ„çš„ç»“æœã€‚</div><div class="chat-message sender"><strong>ä¸“å‘˜ï¼š</strong><br>åŸæ¥å¦‚æ­¤ã€‚ä¹Ÿæ˜¯ï¼Œé‚£ä½å‰¯æ€»å’Œä»–é‚£ä¸€æ´¾å¦‚ä»Šåœ¨å…¬å¸æƒåŠ¿æ­£ç››ï¼Œè¿™æ¬¡æ™‹å‡èƒ½è½åœ¨ä»–ä»¬äººèº«ä¸Šä¹Ÿç®—æ„æ–™ä¹‹ä¸­ã€‚</div><div class="chat-message sender"><strong>ä¸“å‘˜ï¼š</strong><br>æˆ‘è¿™å°±å»å‡†å¤‡å¥½é‚£ä¸ªå‘˜å·¥æ–°çš„äººäº‹ææ–™ã€‚</div></div>`;
        }
        // ä¿®æ”¹ï¼šæ›´æ–°æ™‹å‡åŸå› é€‰æ‹©é¢˜çš„æ ·å¼å’Œæ–‡æœ¬
        
// ä¿®æ”¹ï¼šæ›´æ–°æ™‹å‡åŸå› é€‰æ‹©é¢˜çš„æ ·å¼å’Œæ–‡æœ¬
        const questionHtml = `
            <div id="mystery-question-container" style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 8px; opacity: 0; transition: opacity 0.5s;">
                <p style="font-weight: bold; margin-bottom: 15px;">æ ¹æ®æ‚¨çš„ç†è§£ï¼Œæ‚¨æ­¤æ¬¡æ™‹å‡æœ€ä¸»è¦çš„åŸå› æ˜¯ï¼š</p>
                <div class="likert-scale">
                    <label class="likert-option">
                        <input type="radio" name="promotion-reason" value="1" class="likert-radio" onchange="document.getElementById('continue-after-mystery').style.display = 'block';">
                        <span class="likert-label label-align-right">1<br>å®Œå…¨å‡ºäºäººé™…å…³ç³»ã€æ´¾ç³»æ”¯æŒã€é¢†å¯¼ç§å¿ƒä¸åå¥½</span>
                    </label>
                    <label class="likert-option">
                        <input type="radio" name="promotion-reason" value="2" class="likert-radio" onchange="document.getElementById('continue-after-mystery').style.display = 'block';">
                        <span class="likert-label">2</span>
                    </label>
                    <label class="likert-option">
                        <input type="radio" name="promotion-reason" value="3" class="likert-radio" onchange="document.getElementById('continue-after-mystery').style.display = 'block';">
                        <span class="likert-label">3</span>
                    </label>
                    <label class="likert-option">
                        <input type="radio" name="promotion-reason" value="4" class="likert-radio" onchange="document.getElementById('continue-after-mystery').style.display = 'block';">
                        <span class="likert-label">4<br>ä¸ç¡®å®š</span>
                    </label>
                    <label class="likert-option">
                        <input type="radio" name="promotion-reason" value="5" class="likert-radio" onchange="document.getElementById('continue-after-mystery').style.display = 'block';">
                        <span class="likert-label">5</span>
                    </label>
                    <label class="likert-option">
                        <input type="radio" name="promotion-reason" value="6" class="likert-radio" onchange="document.getElementById('continue-after-mystery').style.display = 'block';">
                        <span class="likert-label">6</span>
                    </label>
                    <label class="likert-option">
                        <input type="radio" name="promotion-reason" value="7" class="likert-radio" onchange="document.getElementById('continue-after-mystery').style.display = 'block';">
                        <span class="likert-label label-align-left">7<br>å®Œå…¨å‡ºäºä¸ªäººèƒ½åŠ›ã€åŠªåŠ›ã€å·¥ä½œè¡¨ç°ä¸å®é™…è´¡çŒ®</span>
                    </label>
                </div>
            </div>
        `;


        chatDisplay.style.display = 'block';
        const mysteriousBox = mysteryNoteSection.querySelector('.mysterious-box');
        mysteriousBox.insertAdjacentHTML('beforeend', questionHtml);
        setTimeout(() => {
            const questionContainer = document.getElementById('mystery-question-container');
            if(questionContainer) questionContainer.style.opacity = 1;
        }, 500);
    }, 2000);
};

window.showSurvey = function() {
    const reasonValue = document.querySelector('input[name="promotion-reason"]:checked')?.value;
    gameState.promotionReason = reasonValue || ''; 
    loadSurveyItems();
    navigateTo('survey');
};

window.loadSurveyItems = function() {
    const reciprocalContainer = document.getElementById('reciprocal-items');
    const ruleContainer = document.getElementById('rule-items');
    const entitlementContainer = document.getElementById('entitlement-items-moved'); // å®šä½åˆ°æ–°çš„â€œç¬¬ä¸‰éƒ¨åˆ†â€å®¹å™¨
    
    // æ–°å¢ï¼šè·å–æ–°å®¹å™¨
    const moralIdentityContainer = document.getElementById('moral-identity-items');
    const imposterContainer = document.getElementById('imposter-items');
    const prideContainer = document.getElementById('pride-items');
    const accomplishmentContainer = document.getElementById('accomplishment-items');
    const thrivingContainer = document.getElementById('thriving-items');
    const rbseContainer = document.getElementById('rbse-items');
    const riskContainer = document.getElementById('risk-items-moved');

    // åŠ è½½ç¬¬ä¸€éƒ¨åˆ†
    ruleContainer.innerHTML = '';
    ruleItems.forEach((item, index) => {
        ruleContainer.innerHTML += createLikertItem(`rule_${index}`, item);
    });
    
    // åŠ è½½ç¬¬äºŒéƒ¨åˆ†
    reciprocalContainer.innerHTML = '';
    reciprocalItems.forEach((item, index) => {
        reciprocalContainer.innerHTML += createLikertItem(`reciprocal_${index}`, item);
    });

    // åŠ è½½ç¬¬ä¸‰éƒ¨åˆ† (entitlement)
    entitlementContainer.innerHTML = '';
    entitlementItems.forEach((item, index) => {
        entitlementContainer.innerHTML += createLikertItem(`entitlement_${index}`, item);
    });

    // æ–°å¢ï¼šåŠ è½½ç¬¬å››è‡³ç¬¬åéƒ¨åˆ†
    moralIdentityContainer.innerHTML = '';
    moralIdentityItems.forEach((item, index) => {
        moralIdentityContainer.innerHTML += createLikertItem(`moralIdentity_${index}`, item);
    });

    imposterContainer.innerHTML = '';
    imposterItems.forEach((item, index) => {
        imposterContainer.innerHTML += createLikertItem(`imposter_${index}`, item);
    });

    prideContainer.innerHTML = '';
    prideItems.forEach((item, index) => {
        prideContainer.innerHTML += createLikertItem(`pride_${index}`, item);
    });

    accomplishmentContainer.innerHTML = '';
    accomplishmentItems.forEach((item, index) => {
        accomplishmentContainer.innerHTML += createLikertItem(`accomplishment_${index}`, item);
    });

    thrivingContainer.innerHTML = '';
    thrivingItems.forEach((item, index) => {
        thrivingContainer.innerHTML += createLikertItem(`thriving_${index}`, item);
    });

    rbseContainer.innerHTML = '';
    const rbseScales = ['éå¸¸ä¸è‡ªä¿¡', 'ä¸è‡ªä¿¡', 'æœ‰ç‚¹ä¸è‡ªä¿¡', 'ä¸­ç«‹', 'æœ‰ç‚¹è‡ªä¿¡', 'è‡ªä¿¡', 'éå¸¸è‡ªä¿¡'];
    rbseItems.forEach((item, index) => {
        rbseContainer.innerHTML += `<div class="questionnaire-item"><p>${item}</p><div class="likert-scale">${rbseScales.map((scale, i) => `<label class="likert-option"><input type="radio" name="rbse_${index}" value="${i + 1}" class="likert-radio"><span class="likert-label">${scale}</span></label>`).join('')}</div></div>`;
    });
    
    riskContainer.innerHTML = '';
    riskPreferenceItems.forEach((item, index) => {
        riskContainer.innerHTML += createLikertItem(`riskPreference_${index}`, item);
    });
};


window.createLikertItem = function(name, text) {
    // const scales = ['éå¸¸ä¸åŒæ„', 'ä¸åŒæ„', 'æœ‰ç‚¹ä¸åŒæ„', 'ä¸­ç«‹', 'æœ‰ç‚¹åŒæ„', 'åŒæ„', 'éå¸¸åŒæ„']; // <-- åˆ é™¤è¿™ä¸€è¡Œ
    // ä½¿ç”¨å…¨å±€ç»Ÿä¸€çš„é‡è¡¨
    return `<div class="questionnaire-item"><p>${text}</p><div class="likert-scale">${scalesAgreement.map((scale, i) => `<label class="likert-option"><input type="radio" name="${name}" value="${i + 1}" class="likert-radio"><span class="likert-label">${scale}</span></label>`).join('')}</div></div>`;
};


window.submitSurvey = function() {
    const ruleAnswers = [];
    const reciprocalAnswers = [];
    const entitlementAnswers = []; // æ–°å¢
    // æ–°å¢ï¼šä¸ºæ–°æ•°æ®æ·»åŠ æ•°ç»„
    const moralIdentityAnswers = [];
    const imposterAnswers = [];
    const prideAnswers = [];
    const accomplishmentAnswers = [];
    const thrivingAnswers = [];
    const rbseAnswers = [];
    const riskPreferenceAnswers = [];

    let firstUnanswered = null;

    document.getElementById('survey-error').textContent = '';
    document.querySelectorAll('.questionnaire-item.error').forEach(el => el.classList.remove('error'));

    // æ”¶é›†è§„åˆ™é¢˜ç­”æ¡ˆ
    for (let i = 0; i < ruleItems.length; i++) {
        const checked = document.querySelector(`input[name="rule_${i}"]:checked`);
        if (checked) { ruleAnswers.push({ item: i, value: parseInt(checked.value) }); } 
        else if (!firstUnanswered) { firstUnanswered = document.querySelector(`input[name="rule_${i}"]`).closest('.questionnaire-item'); }
    }

    // æ”¶é›†äº’æƒ é¢˜ç­”æ¡ˆ
    for (let i = 0; i < reciprocalItems.length; i++) {
        const checked = document.querySelector(`input[name="reciprocal_${i}"]:checked`);
        if (checked) { reciprocalAnswers.push({ item: i, value: parseInt(checked.value) }); } 
        else if (!firstUnanswered) { firstUnanswered = document.querySelector(`input[name="reciprocal_${i}"]`).closest('.questionnaire-item'); }
    }

    // æ–°å¢ï¼šæ”¶é›†å¿ƒç†ç‰¹æƒé¢˜ç­”æ¡ˆ
    for (let i = 0; i < entitlementItems.length; i++) {
        const checked = document.querySelector(`input[name="entitlement_${i}"]:checked`);
        if (checked) { entitlementAnswers.push({ item: i, value: parseInt(checked.value) }); }
        else if (!firstUnanswered) { firstUnanswered = document.querySelector(`input[name="entitlement_${i}"]`).closest('.questionnaire-item'); }
    }
    
    // æ–°å¢ï¼šæ”¶é›†æ–°é—®å·æ•°æ®
    for (let i = 0; i < moralIdentityItems.length; i++) {
        const checked = document.querySelector(`input[name="moralIdentity_${i}"]:checked`);
        if (checked) { moralIdentityAnswers.push({ item: i, value: parseInt(checked.value) }); }
        else if (!firstUnanswered) { firstUnanswered = document.querySelector(`input[name="moralIdentity_${i}"]`).closest('.questionnaire-item'); }
    }

    for (let i = 0; i < imposterItems.length; i++) {
        const checked = document.querySelector(`input[name="imposter_${i}"]:checked`);
        if (checked) { imposterAnswers.push({ item: i, value: parseInt(checked.value) }); }
        else if (!firstUnanswered) { firstUnanswered = document.querySelector(`input[name="imposter_${i}"]`).closest('.questionnaire-item'); }
    }

    for (let i = 0; i < prideItems.length; i++) {
        const checked = document.querySelector(`input[name="pride_${i}"]:checked`);
        if (checked) { prideAnswers.push({ item: i, value: parseInt(checked.value) }); }
        else if (!firstUnanswered) { firstUnanswered = document.querySelector(`input[name="pride_${i}"]`).closest('.questionnaire-item'); }
    }

    for (let i = 0; i < accomplishmentItems.length; i++) {
        const checked = document.querySelector(`input[name="accomplishment_${i}"]:checked`);
        if (checked) { accomplishmentAnswers.push({ item: i, value: parseInt(checked.value) }); }
        else if (!firstUnanswered) { firstUnanswered = document.querySelector(`input[name="accomplishment_${i}"]`).closest('.questionnaire-item'); }
    }

    for (let i = 0; i < thrivingItems.length; i++) {
        const checked = document.querySelector(`input[name="thriving_${i}"]:checked`);
        if (checked) { thrivingAnswers.push({ item: i, value: parseInt(checked.value) }); }
        else if (!firstUnanswered) { firstUnanswered = document.querySelector(`input[name="thriving_${i}"]`).closest('.questionnaire-item'); }
    }

    for (let i = 0; i < rbseItems.length; i++) {
        const checked = document.querySelector(`input[name="rbse_${i}"]:checked`);
        if (checked) { rbseAnswers.push({ item: i, value: parseInt(checked.value) }); }
        else if (!firstUnanswered) { firstUnanswered = document.querySelector(`input[name="rbse_${i}"]`).closest('.questionnaire-item'); }
    }
    
    for (let i = 0; i < riskPreferenceItems.length; i++) {
        const checked = document.querySelector(`input[name="riskPreference_${i}"]:checked`);
        if (checked) { riskPreferenceAnswers.push({ item: i, value: parseInt(checked.value) }); }
        else if (!firstUnanswered) { firstUnanswered = document.querySelector(`input[name="riskPreference_${i}"]`).closest('.questionnaire-item'); }
    }
    
    if (firstUnanswered) {
        document.getElementById('survey-error').textContent = 'æ‚¨è¿˜æœ‰æœªå®Œæˆçš„é¢˜ç›®ï¼Œè¯·æ£€æŸ¥å¹¶è¡¥å……å®Œæ•´ã€‚';
        firstUnanswered.classList.add('error');
        firstUnanswered.scrollIntoView({ behavior: 'smooth', block: 'center' });
        return;
    }

    gameState.surveyData = {
        rule: ruleAnswers,
        reciprocal: reciprocalAnswers,
        entitlement: entitlementAnswers, // æ–°å¢
        // æ–°å¢ï¼šå°†æ–°æ•°æ®å­˜å…¥ gameState
        moralIdentity: moralIdentityAnswers,
        imposter: imposterAnswers,
        pride: prideAnswers,
        accomplishment: accomplishmentAnswers,
        thriving: thrivingAnswers,
        rbse: rbseAnswers,
        riskPreference: riskPreferenceAnswers
    };

   navigateTo('pre-scenarios'); 
};


window.loadManagementScenario = function() {
    // æ ¹æ®æ™‹å‡çº§åˆ«ï¼Œå†³å®šä½¿ç”¨å“ªä¸€å¥—æƒ…æ™¯é¢˜
    const promotionLevel = gameState.promotionLevel || 'L3'; // å¦‚æœå‘ç”Ÿæ„å¤–ï¼Œåˆ™é»˜è®¤ä¸ºL3
    let scenariosToUse = managementScenarios[promotionLevel];
    if (!scenariosToUse) {
        console.error('æœªæ‰¾åˆ°çº§åˆ« ' + promotionLevel + ' çš„æƒ…æ™¯é¢˜ï¼Œå°†ä½¿ç”¨é»˜è®¤çš„L3é¢˜åº“ã€‚');
        scenariosToUse = managementScenarios['L3'];
    }

    // --- æ–°çš„å›ºå®šé¡ºåºä»£ç  (å…ˆ8é“è§„åˆ™é¢˜ï¼Œå8é“äº’æƒ é¢˜) ---
    const ruleScenarios = scenariosToUse.rule.map(s => ({...s, type: 'rule'}));
    const reciprocalScenarios = scenariosToUse.reciprocal.map(s => ({...s, type: 'reciprocal'}));
    
    // ç›´æ¥æ‹¼æ¥ä¸¤ä¸ªæ•°ç»„ï¼Œå®ç°è§„åˆ™é¢˜åœ¨å‰ï¼Œäº’æƒ é¢˜åœ¨å
    const allScenarios = [...ruleScenarios, ...reciprocalScenarios];
    
    gameState.managementScenarios = allScenarios;
    gameState.currentScenario = 0;
    gameState.behaviorData = { rule: [], reciprocal: [] };

    navigateTo('management-scenarios');
    loadScenario();
};

// ===== å¼€å§‹ï¼šè¿™æ˜¯æ”¯æŒåŠ¨æ€é€‰é¡¹çš„æœ€ç»ˆç‰ˆ loadScenario å‡½æ•° =====
window.loadScenario = function() {
    if (gameState.currentScenario >= gameState.managementScenarios.length) {
        gameState.scenariosCompleted = true;
loadPostSurveyItems();
       navigateTo('post-scenario-survey');
        return;
    }

    const scenario = gameState.managementScenarios[gameState.currentScenario];
    const container = document.getElementById('management-scenarios');
    const contentDiv = document.getElementById('scenario-content');
    const optionsDiv = document.getElementById('scenario-options');
    
    window.scrollTo(0, 0);

    contentDiv.innerHTML = `
        <div class="info-box" style="margin-bottom: 25px;">
            <p style="font-size: 18px; line-height: 1.8;">${scenario.text}</p>
        </div>
        <h3 style="font-size: 20px;">${scenario.prompt}</h3>
    `;

    // å…³é”®ä¿®æ”¹ï¼šä»å½“å‰é¢˜ç›®å¯¹è±¡ä¸­è·å–åŠ¨æ€çš„é€‰é¡¹æ ‡ç­¾
    const scenarioLabels = scenario.labels;
    let likertHtml = '<div class="likert-scale" style="padding-bottom: 10px;">';

    for (let i = 1; i <= 7; i++) {
        // ä½¿ç”¨ scenarioLabels æ•°ç»„æ¥åŠ¨æ€ç”Ÿæˆæ¯ä¸ªé€‰é¡¹çš„æ–‡å­—
        likertHtml += `
            <label class="likert-option">
                <input type="radio" name="scenario_choice" value="${i}" class="likert-radio">
                <span class="likert-label">${i}<br>${scenarioLabels[i-1]}</span>
            </label>
        `;
    }
    likertHtml += '</div><div id="scenario-error" class="error-hint" style="text-align: center; margin-bottom: 15px; font-size: 16px;"></div>';
    optionsDiv.innerHTML = likertHtml;
    
    const oldButton = document.getElementById('scenario-next-btn');
    if (oldButton) {
        oldButton.remove();
    }
    
    const nextButton = document.createElement('button');
    nextButton.id = 'scenario-next-btn';
    nextButton.textContent = 'ä¸‹ä¸€æ­¥';
    nextButton.onclick = handleScenarioChoice;
    container.appendChild(nextButton);
};


window.handleScenarioChoice = function() {
    const choice = document.querySelector('input[name="scenario_choice"]:checked');
    const errorHint = document.getElementById('scenario-error');
    
    if (!choice) {
        errorHint.textContent = 'è¯·å…ˆåšå‡ºé€‰æ‹©å†è¿›å…¥ä¸‹ä¸€é¢˜ã€‚';
        return;
    }
    errorHint.textContent = '';

    const currentScenarioData = gameState.managementScenarios[gameState.currentScenario];
    const answer = {
        id: currentScenarioData.id,
        value: parseInt(choice.value, 10)
    };

    if (currentScenarioData.type === 'rule') {
        gameState.behaviorData.rule.push(answer);
    } else if (currentScenarioData.type === 'reciprocal') {
        gameState.behaviorData.reciprocal.push(answer);
    }

    gameState.currentScenario++;
    loadScenario();
};
// ===== ç»“æŸï¼šæ–°ä»£ç åˆ°æ­¤ç»“æŸ =====


window.loadPostSurveyItems = function() {
    const deceptionContainer = document.getElementById('deception-items');
    const cwbContainer = document.getElementById('cwb-items');
    const voiceContainer = document.getElementById('voice-items');
    const takingChargeContainer = document.getElementById('taking-charge-items');

    const scales1 = ['éå¸¸ä¸å¯èƒ½', 'ä¸å¯èƒ½', 'æœ‰ç‚¹ä¸å¯èƒ½', 'ä¸­ç«‹', 'æœ‰ç‚¹å¯èƒ½', 'å¯èƒ½', 'éå¸¸å¯èƒ½'];
    // const scales2 = ['éå¸¸ä¸åŒæ„', 'ä¸åŒæ„', 'æœ‰ç‚¹ä¸åŒæ„', 'ä¸­ç«‹', 'æœ‰ç‚¹åŒæ„', 'åŒæ„', 'éå¸¸åŒæ„']; // <-- æ­¤è¡Œè¢«æ›¿æ¢

    deceptionContainer.innerHTML = '';
    deceptionItems.forEach((item, index) => {
        deceptionContainer.innerHTML += `<div class="questionnaire-item"><p>${item}</p><div class="likert-scale">${scales1.map((scale, i) => `<label class="likert-option"><input type="radio" name="deception_${index}" value="${i + 1}" class="likert-radio"><span class="likert-label">${scale}</span></label>`).join('')}</div></div>`;
    });

    cwbContainer.innerHTML = '';
    cwbItems.forEach((item, index) => {
        cwbContainer.innerHTML += `<div class="questionnaire-item"><p>${item}</p><div class="likert-scale">${scales1.map((scale, i) => `<label class="likert-option"><input type="radio" name="cwb_${index}" value="${i + 1}" class="likert-radio"><span class="likert-label">${scale}</span></label>`).join('')}</div></div>`;
    });
    
    voiceContainer.innerHTML = '';
    voiceItems.forEach((item, index) => {
        // ä½¿ç”¨å…¨å±€ scalesAgreement
        voiceContainer.innerHTML += `<div class="questionnaire-item"><p>${item}</p><div class="likert-scale">${scalesAgreement.map((scale, i) => `<label class="likert-option"><input type="radio" name="voice_${index}" value="${i + 1}" class="likert-radio"><span class="likert-label">${scale}</span></label>`).join('')}</div></div>`;
    });
    
    takingChargeContainer.innerHTML = '';
    takingChargeItems.forEach((item, index) => {
        takingChargeContainer.innerHTML += `<div class="questionnaire-item"><p>${item}</p><div class="likert-scale">${scales1.map((scale, i) => `<label class="likert-option"><input type="radio" name="takingCharge_${index}" value="${i + 1}" class="likert-radio"><span class="likert-label">${scale}</span></label>`).join('')}</div></div>`;
    });
};



window.submitPostSurvey = function() {
    const deceptionAnswers = [];
    const cwbAnswers = [];
    const voiceAnswers = [];
    const takingChargeAnswers = [];
    let firstUnanswered = null;

    document.getElementById('post-survey-error').textContent = '';
    document.querySelectorAll('#post-scenario-survey .questionnaire-item.error').forEach(el => el.classList.remove('error'));

    for (let i = 0; i < deceptionItems.length; i++) {
        const checked = document.querySelector(`input[name="deception_${i}"]:checked`);
        if (checked) { deceptionAnswers.push({ item: i, value: parseInt(checked.value) }); } 
        else if (!firstUnanswered) { firstUnanswered = document.querySelector(`input[name="deception_${i}"]`).closest('.questionnaire-item'); }
    }
    
    for (let i = 0; i < cwbItems.length; i++) {
        const checked = document.querySelector(`input[name="cwb_${i}"]:checked`);
        if (checked) { cwbAnswers.push({ item: i, value: parseInt(checked.value) }); } 
        else if (!firstUnanswered) { firstUnanswered = document.querySelector(`input[name="cwb_${i}"]`).closest('.questionnaire-item'); }
    }

    for (let i = 0; i < voiceItems.length; i++) {
        const checked = document.querySelector(`input[name="voice_${i}"]:checked`);
        if (checked) { voiceAnswers.push({ item: i, value: parseInt(checked.value) }); } 
        else if (!firstUnanswered) { firstUnanswered = document.querySelector(`input[name="voice_${i}"]`).closest('.questionnaire-item'); }
    }
    
    for (let i = 0; i < takingChargeItems.length; i++) {
        const checked = document.querySelector(`input[name="takingCharge_${i}"]:checked`);
        if (checked) { takingChargeAnswers.push({ item: i, value: parseInt(checked.value) }); } 
        else if (!firstUnanswered) { firstUnanswered = document.querySelector(`input[name="takingCharge_${i}"]`).closest('.questionnaire-item'); }
    }
    
    if (firstUnanswered) {
        document.getElementById('post-survey-error').textContent = 'æ‚¨è¿˜æœ‰æœªå®Œæˆçš„é¢˜ç›®ï¼Œè¯·æ£€æŸ¥å¹¶è¡¥å……å®Œæ•´ã€‚';
        firstUnanswered.classList.add('error');
        firstUnanswered.scrollIntoView({ behavior: 'smooth', block: 'center' });
        return;
    }

    gameState.postScenarioSurveyData = {
        deception: deceptionAnswers,
        cwb: cwbAnswers,
        voice: voiceAnswers,
        takingCharge: takingChargeAnswers
    };

   navigateTo('pre-demographics'); // å¯¼èˆªåˆ°ä¸‹ä¸€é¡µ
};
// --- æ·»åŠ æ–°å‡½æ•°ç»“æŸ ---

window.loadAndGoToDemographics = function() {
    // honesty-items åŠå…¶å†…å®¹å·²è¢«åˆ é™¤ï¼Œæ­¤å‡½æ•°ç°åœ¨åªè´Ÿè´£å¯¼èˆª
    navigateTo('demographics');
};


window.toggleDrivingYears = function() { /* ... demographics logic ... */ };



window.finishExperiment = function() {
    const errorHint = document.getElementById('demographics-error'); // ä½¿ç”¨åˆå¹¶åçš„é”™è¯¯æç¤ºæ¡†
    errorHint.textContent = ''; // æ¸…ç©ºé”™è¯¯æç¤º

    // 1. è·å–äººå£ç»Ÿè®¡æ•°æ®
    const demographicsData = {
        gender: document.querySelector('input[name="gender"]:checked')?.value,
        age: document.getElementById('age-select')?.value,
        education: document.querySelector('input[name="education"]:checked')?.value,
        experience: document.querySelector('input[name="experience"]:checked')?.value,
        smartDriving: document.querySelector('input[name="smart-driving"]:checked')?.value,
        algorithmExp: document.querySelector('input[name="algorithm-exp"]:checked')?.value,
    };

// --- æ·»åŠ è¿™è¡Œä»£ç  ---
const understanding = document.querySelector('input[name="understanding"]:checked')?.value;
   
    // 3. éªŒè¯æ‰€æœ‰æ•°æ®
    let allValid = true;
    for (const key in demographicsData) {
        if (!demographicsData[key]) {
            allValid = false;
            break;
        }
    }
    if (!allValid || !understanding) {
        errorHint.textContent = 'æ‚¨è¿˜æœ‰æœªå®Œæˆçš„é¢˜ç›®ï¼Œè¯·æ£€æŸ¥å¹¶è¡¥å……å®Œæ•´ã€‚';
        return;
    }

    // 4. ä¿å­˜æ‰€æœ‰æ•°æ®
    gameState.demographics = demographicsData; // ä¿å­˜äººå£ç»Ÿè®¡æ•°æ®

    gameState.personalityData = {
    // riskPreference å’Œ honesty å·²è¢«åˆ é™¤
    // entitlement å·²åœ¨ surveyData ä¸­ä¿å­˜
    understanding: parseInt(understanding)
};

    gameState.endTime = new Date();
    gameState.participantId = 'P' + Date.now() + Math.random().toString(36).substr(2, 5).toUpperCase();

    navigateTo('complete');

    // 5. å‡†å¤‡ LeanCloud å¯¹è±¡
    const ExperimentData = AV.Object.extend('ExperimentData');
    const experimentData = new ExperimentData();

    experimentData.set('participantId', gameState.participantId);
    experimentData.set('startTime', gameState.startTime);
    experimentData.set('endTime', gameState.endTime);
    experimentData.set('durationMinutes', ((gameState.endTime - gameState.startTime) / 60000).toFixed(2));

    experimentData.set('yearTaskCorrectCount', gameState.yearTaskAnswers.filter(a => a && a.correct).length);
    experimentData.set('mainTaskCorrectCount', gameState.correctAnswers);

    experimentData.set('promotionType', gameState.promotionType || 'N/A');
    experimentData.set('promotionLevel', gameState.promotionLevel || 'N/A');
    experimentData.set('promotionUnderstanding', gameState.promotionUnderstanding || 'N/A');
    experimentData.set('promotionReasonPerceived', gameState.promotionReason || 'N/A');
    experimentData.set('promotionReasonActual', gameState.mysteryReason || 'N/A');

    experimentData.set('surveyData', gameState.surveyData || {});
    experimentData.set('behaviorData', gameState.behaviorData || {});
    experimentData.set('postScenarioSurveyData', gameState.postScenarioSurveyData || {}); // ç¡®ä¿æ­¤è¡Œå­˜åœ¨
    experimentData.set('demographics', gameState.demographics || {});
    experimentData.set('personalityData', gameState.personalityData || {});

    experimentData.save().then(
        (result) => {
            console.log('æ•°æ®ä¿å­˜æˆåŠŸ', result);
            document.getElementById('participant-id-display').textContent = gameState.participantId;
            navigateTo('thank-you');
        },
        (error) => {
            console.error('ä¿å­˜å¤±è´¥:', error);
            alert('æ•°æ®è‡ªåŠ¨æäº¤å¤±è´¥ï¼Œè¯·è”ç³»ç ”ç©¶äººå‘˜ã€‚');
        }
    );
};

console.log('å®éªŒç³»ç»Ÿå·²åŠ è½½å®Œæ¯•ï¼Œæ‰€æœ‰åŠŸèƒ½æ­£å¸¸');
</script>
</body>
</html>